<!DOCTYPE html>
<html lang="it">


<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Strush | I soldi non crescono sugli alberi</title>

    <!-- Meta tag per il nome dell'applicazione -->
    <meta name="application-name" content="Strush">
    
    <!-- Meta tags per Open Graph (Facebook, LinkedIn, ecc.) -->
    <meta property="og:title" content="Strush | I soldi non crescono sugli alberi">
    <meta property="og:description" content="Spese pazze o amico fantasma al conto? Con Strush si gioca sul serio">
    <meta property="og:image" content="https://github.com/cristianomiolla/strush/blob/main/immagini/pittogramma.png?raw=true">
    <meta property="og:url" content="https://cristianomiolla.github.io/strush/">
    <meta property="og:type" content="website">
    
    <!-- Meta tags per Twitter Card (utili anche per altri servizi) -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Strush | I soldi non crescono sugli alberi">
    <meta name="twitter:description" content="Spese pazze o amico fantasma al conto? Con Strush si gioca sul serio">
    <meta name="twitter:image" content="https://github.com/cristianomiolla/strush/blob/main/immagini/pittogramma.png?raw=true">
    
    <!-- Collegamento ai font awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Favicon -->
    <link rel="icon" href="immagini/pittogramma_trasp.png" type="image/png">
    <link rel="shortcut icon" href="immagini/pittogramma_trasp.png" type="image/png">

<link rel="stylesheet" href="style.css">
    

    <!-- Animazione sui titoli -->
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const sectionTitles = document.querySelectorAll('.section-title');

        // Wrappa il testo
        sectionTitles.forEach(title => {
            const text = title.textContent;
            title.innerHTML = `<span class="title-wrapper">${text}</span>`;
        });

        function isPartiallyInViewport(el) {
            const rect = el.getBoundingClientRect();
            const windowHeight = window.innerHeight || document.documentElement.clientHeight;
            const windowWidth = window.innerWidth || document.documentElement.clientWidth;

            return (
                rect.top < windowHeight &&
                rect.bottom >= 0 &&
                rect.left < windowWidth &&
                rect.right >= 0
            );
        }

        function handleTitleReveal() {
            sectionTitles.forEach(title => {
                if (!title.classList.contains('reveal') && isPartiallyInViewport(title)) {
                    title.classList.add('reveal');
                }
            });
        }

        // Controllo iniziale
        handleTitleReveal();

        // Listener per lo scroll e resize
        window.addEventListener('scroll', handleTitleReveal);
        window.addEventListener('resize', handleTitleReveal);

        // Rimozione del listener quando tutti i titoli sono rivelati
        const allRevealed = () => 
            Array.from(sectionTitles).every(title => title.classList.contains('reveal'));

        const titleObserver = new MutationObserver(() => {
            if (allRevealed()) {
                window.removeEventListener('scroll', handleTitleReveal);
                window.removeEventListener('resize', handleTitleReveal);
                titleObserver.disconnect();
            }
        });

        // Osserva i cambiamenti di classe
        sectionTitles.forEach(title => {
            titleObserver.observe(title, {
                attributes: true,
                attributeFilter: ['class']
            });
        });
    });
</script>


    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-ZTP9KKD7VG"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-ZTP9KKD7VG');
</script>


</head>


<body>

    <!-- Preloader -->
<div id="strush-preloader">
    <!-- Blob shapes as background -->
    <div class="strush-blob blob1"></div>
    <div class="strush-blob blob2"></div>
    <div class="strush-blob blob3"></div>
    <div class="strush-blob blob4"></div>
    
    <div class="strush-loading-animation">
        <!-- Dinosauro con spine e barra di caricamento -->
        <div class="strush-dino-container">
            <div class="strush-dino">
                <div class="strush-dino-body"></div>
                <div class="strush-dino-head"></div>
                <div class="strush-dino-spines">
                    <div class="spine s1"></div>
                    <div class="spine s2"></div>
                    <div class="spine s3"></div>
                    <div class="spine s4"></div>
                    <div class="spine s5"></div>
                </div>
                <div class="strush-dino-tail"></div>
                <div class="strush-dino-leg left"></div>
                <div class="strush-dino-leg right"></div>
            </div>
            <div class="strush-dino-shadow"></div>
        </div>
        
        <!-- Barra di progresso -->
        <div class="strush-progress-bar">
            <div class="strush-progress-fill"></div>
        </div>
        
        <div class="strush-loading-text">Caricamento<span class="strush-dots">...</span></div>
    </div>
</div>

<style>
    /* Preloader */
    #strush-preloader {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: #121212;
        z-index: 9999;
        display: flex;
        justify-content: center;
        align-items: center;
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        overflow: hidden;
    }

    /* Blob Shapes */
    .strush-blob {
        position: absolute;
        border-radius: 50%;
        filter: blur(20px);
        opacity: 0.15;
        z-index: 1;
    }

    .strush-blob.blob1 {
        width: 300px;
        height: 300px;
        background: #9495EA;
        top: 20%;
        left: 15%;
        animation: blob-morph1 20s ease-in-out infinite alternate;
    }

    .strush-blob.blob2 {
        width: 350px;
        height: 350px;
        background: #84CD9D;
        bottom: 20%;
        right: 15%;
        animation: blob-morph2 25s ease-in-out infinite alternate;
    }

    .strush-blob.blob3 {
        width: 200px;
        height: 200px;
        background: #BFACFA;
        top: 60%;
        left: 25%;
        animation: blob-morph3 18s ease-in-out infinite alternate;
    }

    .strush-blob.blob4 {
        width: 250px;
        height: 250px;
        background: #A4FACF;
        top: 30%;
        right: 25%;
        animation: blob-morph4 22s ease-in-out infinite alternate;
    }

    .strush-loading-animation {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        position: relative;
        z-index: 2;
    }

    /* Dinosauro */
    .strush-dino-container {
        position: relative;
        width: 100px;
        height: 80px;
        margin-bottom: 15px;
    }

    .strush-dino {
        position: relative;
        width: 60px;
        height: 40px;
        margin: 0 auto;
        animation: bounce 0.8s infinite alternate;
    }

    .strush-dino-body {
        position: absolute;
        width: 35px;
        height: 20px;
        background: #9495EA;
        border-radius: 10px 15px 8px 8px;
        top: 15px;
        left: 10px;
    }

    .strush-dino-head {
        position: absolute;
        width: 20px;
        height: 15px;
        background: #9495EA;
        border-radius: 8px 12px 5px 5px;
        top: 12px;
        left: 40px;
    }

    .strush-dino-head:after {
        content: '';
        position: absolute;
        width: 3px;
        height: 3px;
        background: #000;
        border-radius: 50%;
        top: 5px;
        right: 5px;
    }

    /* Spine dorsali appuntite */
    .strush-dino-spines {
        position: absolute;
        top: 5px;
        left: 12px;
        z-index: 5;
    }

    .spine {
        position: absolute;
        background: #84CD9D;
        width: 2px;
        transform-origin: bottom center;
        box-shadow: 0 0 4px rgba(180, 250, 205, 0.6);
        clip-path: polygon(0% 0%, 100% 0%, 50% 100%);
        border-radius: 0;
    }

    .spine:before {
        content: '';
        position: absolute;
        width: 0;
        height: 0;
        border-left: 4px solid transparent;
        border-right: 4px solid transparent;
        border-bottom: 8px solid #84CD9D;
        top: -7px;
        left: -3px;
    }

    .spine:after {
        content: '';
        position: absolute;
        width: 4px;
        height: 2px;
        background: #84CD9D;
        border-radius: 50%;
        bottom: -1px;
        left: -1px;
    }

    .spine.s1 {
        height: 10px;
        top: -6px;
        left: -0px;
        transform: rotate(-196deg);
    }

    .spine.s2 {
        height: 16px;
        top: -19px;
        left: 5px;
        transform: rotate(-190deg);
    }

    .spine.s3 {
        height: 18px;
        top: -23.5px;
        left: 14px;
        transform: rotate(183deg);
    }

    .spine.s4 {
        height: 14px;
        top: -15px;
        left: 21px;
        transform: rotate(190deg);
    }

    .spine.s5 {
        height: 9px;
        top: -04px;
        left: 27px;
        transform: rotate(200deg);
    }

    .strush-dino-tail {
        position: absolute;
        width: 22px;
        height: 8px;
        background: #9495EA;
        border-radius: 50% 0 0 50%;
        top: 18px;
        left: -8px;
        transform-origin: right center;
        transform: rotate(-15deg) skewY(-10deg);
        animation: wag 0.6s infinite alternate;
        z-index: 1;
    }


    .strush-dino-leg {
        position: absolute;
        width: 4px;
        height: 15px;
        background: #9495EA;
        bottom: -5px;
        border-radius: 2px;
    }

    .strush-dino-leg.left {
        left: 15px;
        animation: step-left 0.8s infinite alternate;
    }

    .strush-dino-leg.right {
        left: 30px;
        animation: step-right 0.8s infinite alternate;
    }

    .strush-dino-shadow {
        position: absolute;
        width: 40px;
        height: 6px;
        background: rgba(0, 0, 0, 0.3);
        border-radius: 50%;
        bottom: -8px;
        left: 50%;
        transform: translateX(-50%);
        filter: blur(2px);
        animation: shadow-pulse 0.8s infinite alternate;
    }

    /* Barra di progresso */
    .strush-progress-bar {
        width: 200px;
        height: 6px;
        background: #6B6F6E;
        border-radius: 32px;
        overflow: hidden;
        margin-bottom: 16px;
    }

    .strush-progress-fill {
        height: 100%;
        background: linear-gradient(135deg, #84CD9D 0%, #9495EA 100%);
        width: 0;
        border-radius: 3px;
        animation: fill 2s infinite;
    }

    .strush-loading-text {
        color: white;
        font-size: 16px;
        letter-spacing: 2px;
        font-weight: 500;
        text-shadow: 0 0px 20px #9495EA66;
    }

    .strush-dots {
        display: inline-block;
        width: 30px;
        animation: dots 1.5s infinite;
    }

    /* Animazioni */
    @keyframes bounce {
        0% {
            transform: translateY(0);
        }
        100% {
            transform: translateY(-5px);
        }
    }

    @keyframes wag {
        0% {
            transform: rotate(-15deg) skewY(-10deg);
        }
        100% {
            transform: rotate(-25deg) skewY(-15deg);
        }
    }

    @keyframes step-left {
        0% {
            transform: rotate(-15deg);
        }
        100% {
            transform: rotate(15deg);
        }
    }

    @keyframes step-right {
        0% {
            transform: rotate(15deg);
        }
        100% {
            transform: rotate(-15deg);
        }
    }

    @keyframes shadow-pulse {
        0% {
            transform: translateX(-50%) scale(0.8);
            opacity: 0.2;
        }
        100% {
            transform: translateX(-50%) scale(1);
            opacity: 0.3;
        }
    }

    @keyframes fill {
        0% {
            width: 0;
        }
        50% {
            width: 60%;
        }
        100% {
            width: 100%;
        }
    }

    @keyframes dots {
        0%, 100% {
            content: '';
            opacity: 0.2;
        }
        25% {
            content: '.';
            opacity: 1;
        }
        50% {
            content: '..';
            opacity: 1;
        }
        75% {
            content: '...';
            opacity: 1;
        }
    }

    /* Blob animations */
    @keyframes blob-morph1 {
        0% {
            border-radius: 60% 40% 30% 70% / 60% 30% 70% 40%;
        }
        25% {
            border-radius: 50% 50% 40% 60% / 40% 40% 60% 60%;
        }
        50% {
            border-radius: 30% 70% 70% 30% / 50% 50% 50% 50%;
        }
        75% {
            border-radius: 40% 60% 50% 50% / 30% 70% 30% 70%;
        }
        100% {
            border-radius: 60% 40% 30% 70% / 60% 30% 70% 40%;
        }
    }

    @keyframes blob-morph2 {
        0% {
            border-radius: 40% 60% 70% 30% / 50% 40% 60% 50%;
        }
        25% {
            border-radius: 60% 40% 40% 60% / 70% 30% 70% 30%;
        }
        50% {
            border-radius: 40% 60% 30% 70% / 60% 40% 60% 40%;
        }
        75% {
            border-radius: 30% 70% 60% 40% / 50% 60% 40% 60%;
        }
        100% {
            border-radius: 40% 60% 70% 30% / 50% 40% 60% 50%;
        }
    }

    @keyframes blob-morph3 {
        0% {
            border-radius: 70% 30% 50% 50% / 30% 60% 40% 70%;
        }
        25% {
            border-radius: 50% 50% 60% 40% / 40% 50% 50% 60%;
        }
        50% {
            border-radius: 30% 70% 40% 60% / 70% 30% 70% 30%;
        }
        75% {
            border-radius: 50% 50% 30% 70% / 60% 40% 60% 40%;
        }
        100% {
            border-radius: 70% 30% 50% 50% / 30% 60% 40% 70%;
        }
    }

    @keyframes blob-morph4 {
        0% {
            border-radius: 50% 50% 70% 30% / 40% 60% 40% 60%;
        }
        25% {
            border-radius: 30% 70% 40% 60% / 50% 50% 50% 50%;
        }
        50% {
            border-radius: 60% 40% 30% 70% / 40% 60% 60% 40%;
        }
        75% {
            border-radius: 40% 60% 50% 50% / 60% 40% 50% 50%;
        }
        100% {
            border-radius: 50% 50% 70% 30% / 40% 60% 40% 60%;
        }
    }

    /* Animazione fade-out */
    #strush-preloader.fade-out {
        opacity: 0;
        transition: opacity 0.5s ease;
        pointer-events: none;
    }

    /* Responsive */
    @media (max-width: 480px) {
        .strush-progress-bar {
            width: 150px;
        }
        .strush-blob {
            opacity: 0.1;
            transform: scale(0.7);
        }
    }
</style>

<script>
    // Nascondi il preloader quando la pagina è completamente caricata
    window.addEventListener('load', function() {
        const preloader = document.getElementById('strush-preloader');
        
        // Aggiungi un ritardo minimo per garantire che il preloader sia visibile
        setTimeout(function() {
            // Aggiungi una classe per l'animazione di fade-out
            preloader.classList.add('fade-out');
            
            // Rimuovi completamente il preloader dopo l'animazione
            setTimeout(function() {
                preloader.style.display = 'none';
            }, 500);
        }, 800); // Mostra il preloader per almeno 800ms
    });
</script>



    <!-- Download Bar Section -->
<section class="download-bar-section">

    <div class="download-bar" id="downloadBar">
        <div class="ripple-container">
        <span class="ripple"></span>
        <svg class="download-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
            <polyline points="7 10 12 15 17 10"></polyline>
            <line x1="12" y1="15" x2="12" y2="3"></line>
        </svg>
        Scarica l'app
        </div>
    </div>

    <style>
        /* Download bar styling */
        .download-bar {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #121212;
            color: white;
            padding: 16px;
            border-radius: 32px;
            cursor: pointer;
            font-weight: 600;
            font-size: 16px;
            transition: all 0.3s ease;
            z-index: 1000;
            overflow: hidden;
            min-width: 190px;
            text-align: center;
        }
    
        .ripple-container {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            width: 100%;
            height: 100%;
        }
        
        /* Click effect styling */
        .download-bar:active {
            background-color: #222222;
            transition: all 0.1s ease;
        }
    
        /* Ripple effect */
        .ripple {
            position: absolute;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            transform: scale(0);
            pointer-events: none;
            animation: none;
        }
    
        @keyframes ripple-effect {
            to {
            transform: scale(3);
            opacity: 0;
            }
        }
    
        .download-bar:hover {
            transform: translateX(-50%) translateY(-2px);
            box-shadow: 0 2px 8px #9495EA40;

        }
    
        .download-bar.hidden {
            opacity: 0;
            visibility: hidden;
            transform: translateX(-50%) translateY(20px);
        }
    
        .download-icon {
            width: 20px;
            height: 20px;
        }
    
        /* Responsive styling */
        @media (max-width: 768px) {
            .download-bar {
            padding: 16px 24px;
            font-size: 18px;
            width: 85%;
            text-align: center;
            }
        }

    </style>
    
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            // Get reference to the download bar
            const downloadBar = document.getElementById('downloadBar');
            
            // Add click event listener for navigation
            downloadBar.addEventListener('click', function(e) {
            // Get the download section
            const downloadSection = document.getElementById('download');
            
            // If the download section exists, scroll to it smoothly
            if (downloadSection) {
                downloadSection.scrollIntoView({ 
                behavior: 'smooth' 
                });
            }
            
            // Create ripple effect
            const ripple = downloadBar.querySelector('.ripple');
            const rect = downloadBar.getBoundingClientRect();
            
            // Set ripple position based on click coordinates
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            // Set ripple dimensions and position
            ripple.style.width = ripple.style.height = Math.max(rect.width, rect.height) + 'px';
            ripple.style.left = x - (ripple.offsetWidth / 2) + 'px';
            ripple.style.top = y - (ripple.offsetHeight / 2) + 'px';
            
            // Reset animation
            ripple.style.animation = 'none';
            
            // Trigger reflow
            void ripple.offsetWidth;
            
            // Apply animation
            ripple.style.animation = 'ripple-effect 0.6s linear';
            });
            
            // Funzione per controllare se il footer è visibile
            function isFooterVisible() {
            // Troviamo il footer utilizzando vari selettori possibili
            const footer = document.querySelector('footer') || 
                            document.getElementById('footer') || 
                            document.querySelector('.footer') ||
                            document.querySelector('[data-section="footer"]');
            
            if (!footer) return false;
            
            const rect = footer.getBoundingClientRect();
            const windowHeight = window.innerHeight;
            
            // Consideriamo il footer visibile se anche solo una piccola parte è visibile
            return (rect.top < windowHeight && rect.bottom > 0);
            }
            
            // Funzione per aggiornare lo stato della barra
            function updateDownloadBarVisibility() {
            const heroSection = document.getElementById('hero');
            const downloadSection = document.getElementById('download');
            
            function isInViewport(element) {
                if (!element) return false;
                const rect = element.getBoundingClientRect();
                return rect.top < window.innerHeight && rect.bottom > 0;
            }
            
            const heroVisible = isInViewport(heroSection);
            const downloadVisible = isInViewport(downloadSection);
            const footerVisible = isFooterVisible();
            
            if (heroVisible || downloadVisible || footerVisible) {
                downloadBar.classList.add('hidden');
            } else {
                downloadBar.classList.remove('hidden');
            }
            }
            
            // Utilizziamo un approccio misto per massima compatibilità
            // IntersectionObserver per hero e download sections
            if (window.IntersectionObserver) {
            let observedSections = new Set();
            
            const observer = new IntersectionObserver(
                (entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                    observedSections.add(entry.target.id);
                    } else {
                    observedSections.delete(entry.target.id);
                    }
                });
                
                // Controlliamo anche il footer con la nostra funzione personalizzata
                if (observedSections.has('hero') || 
                    observedSections.has('download') || 
                    isFooterVisible()) {
                    downloadBar.classList.add('hidden');
                } else {
                    downloadBar.classList.remove('hidden');
                }
                },
                {
                threshold: 0.1 // Ridotto il threshold per una rilevazione più sensibile
                }
            );
            
            // Osserviamo hero e download
            setTimeout(() => {
                const heroSection = document.getElementById('hero');
                const downloadSection = document.getElementById('download');
                
                if (heroSection) observer.observe(heroSection);
                if (downloadSection) observer.observe(downloadSection);
                
                // Per il footer usiamo scroll event
                window.addEventListener('scroll', function() {
                if (isFooterVisible()) {
                    downloadBar.classList.add('hidden');
                } else if (!observedSections.has('hero') && !observedSections.has('download')) {
                    downloadBar.classList.remove('hidden');
                }
                });
                
                // Verifichiamo subito al caricamento della pagina
                updateDownloadBarVisibility();
            }, 300);
            } else {
            // Fallback completo con scroll event
            window.addEventListener('scroll', updateDownloadBarVisibility);
            // Verifica iniziale
            updateDownloadBarVisibility();
            }
        });
    </script>
    
</section>
      

    <!-- Chatbot -->
<section id="chatbot">
    <div class="chatbot-container" id="chatbot-container" style="display: none;">
        <!-- Audio element for opening sound -->
        <audio id="chatbot-open-sound" preload="auto">
            <source src="sounds/notification.mp3" type="audio/mp3">
            <source src="sounds/notification.ogg" type="audio/ogg">
        </audio>

        <div class="chatbot-box" id="chatbot-box">
            <div class="chatbot-header">
                <div>Dinuccio 🦖</div>
                <div class="chatbot-close" id="chatbot-close">×</div>
            </div>
            <div class="chatbot-messages" id="chatbot-messages">
                <!-- Messages will be dynamically inserted here -->
            </div>
            <div class="chatbot-footer">
                <input type="text" class="chatbot-input" id="chatbot-input" placeholder="Scrivi un messaggio...">
                <button class="chatbot-send" id="chatbot-send">→</button>
            </div>
        </div>

        <!-- Chatbot Icon -->
        <div class="chatbot-icon" id="chatbot-icon">
             <!-- Assicurati che questo percorso sia corretto -->
            <img src="immagini/pittogramma.png" alt="Chat">
        </div>
    </div>

    <style>
        /* Container positioning */
        .chatbot-container {
            position: fixed;
            bottom: 130px;
            right: 20px;
            z-index: 1000;
        }

        /* Chatbot icon styling - MODIFICATO */
        .chatbot-icon {
            /* Dimensioni aumentate per accomodare l'immagine 60x60 + padding 2px per lato */
            width: 60px; 
            height: 60px;
            position: relative;
            cursor: pointer;
            
            border-radius: 60% 40% 65% 35% / 35% 65% 35% 65%;
            
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            
            /* Padding per creare l'effetto bordo visibile (2px per lato) */
            padding: 3px; 
            
            box-sizing: border-box; 
            overflow: hidden; 
            
            transition: transform 0.3s ease, border-radius 0.3s ease;

            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* Icon image styling - MODIFICATO */
        .chatbot-icon img {
            display: block; 
            
            /* L'immagine riempie il 100% dell'area interna al padding (60x60px in questo caso) */
            width: 100%;    
            height: 100%;   
            
            object-fit: contain; 
            background-color: white; 
            border-radius: inherit; 
            
            
            /* Ripristinata la trasformazione originale */
            
            overflow: hidden; 
        }

        /* Morphing animation for chatbot icon (si applica a .chatbot-icon) */
        @keyframes chatbot-icon-morph {
            0%   { border-radius: 60% 40% 65% 35% / 35% 65% 35% 65%; transform: rotate(0deg) scale(1); }
            15%  { border-radius: 55% 45% 70% 30% / 45% 55% 45% 55%; transform: rotate(4deg); }
            30%  { border-radius: 41% 59% 27% 73% / 58% 28% 72% 42%; transform: rotate(9deg); }
            45%  { border-radius: 60% 40% 50% 50% / 35% 65% 35% 65%; transform: rotate(4deg); }
            60%  { border-radius: 55% 45% 35% 65% / 55% 45% 55% 45%; transform: rotate(-9deg); }
            75%  { border-radius: 30% 70% 50% 50% / 60% 40% 60% 40%; transform: rotate(-12deg); }
            90%  { border-radius: 60% 40% 70% 30% / 40% 60% 40% 60%; transform: rotate(-1deg); }
            100% { border-radius: 60% 40% 65% 35% / 35% 65% 35% 65%; transform: rotate(0deg) scale(1); }
        }

        /* Apply morph animation on hover OR when chat is open */
        .chatbot-icon:hover,
        .chatbot-container.chat-is-open .chatbot-icon {
            animation: chatbot-icon-morph 5s infinite;
        }

        /* Chatbot dialog box */
        .chatbot-box {
            position: absolute;
            bottom: 80px; 
            right: 0;
            width: 300px;
            max-width: calc(100vw - 40px);
            height: 400px;
            max-height: calc(100vh - 150px); 
            background-color: #fff;
            border-radius: var(--border-radius-lg);
            box-shadow: 0 4px 10px #9495EA66;
            display: none; 
            flex-direction: column;
            overflow: hidden;
        }

        .chatbot-container.chat-is-open .chatbot-box {
            display: flex;
        }

        .chatbot-header {
            background-color: var(--secondary); 
            color: white;
            padding: 16px;
            font-weight: 700;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background-color 0.3s ease;
        }

        .chatbot-header:hover {
            background-color: var(--primary); 
        }

        .chatbot-close {
            cursor: pointer;
            font-size: 18px;
        }

        .chatbot-messages {
            flex: 1;
            padding: 16px;
            overflow-y: auto;
            background-color: #E6F2F5;
            display: flex;
            flex-direction: column;
            color: var(--text);
        }

        .chatbot-message {
            max-width: 80%;
            padding: 8px;
            margin-bottom: 8px;
            position: relative;
            word-wrap: break-word;
        }

        .bot-message {
            background-color: #fff; 
            align-self: flex-end; 
            margin-left: auto; 
            border-radius: var(--border-radius-lg);
            border-bottom-right-radius: 0; 
        }
        .bot-message::after {
            content: ""; position: absolute; bottom: 0; right: -8px; width: 0; height: 0;
            border-left: 10px solid #fff; 
            border-top: 10px solid transparent; border-bottom: 0 solid transparent;
        }

        .user-message {
            background-color: var(--secondary); color: white;
            align-self: flex-start; 
            margin-right: auto; 
            border-radius: var(--border-radius-lg);
            border-bottom-left-radius: 0; 
        }
        .user-message::after {
            content: ""; position: absolute; bottom: 0; left: -8px; width: 0; height: 0;
            border-right: 10px solid var(--secondary); 
            border-top: 10px solid transparent; border-bottom: 0 solid transparent;
        }

        .typing-indicator {
            background-color: #fff; padding: 8px; border-radius: var(--border-radius-lg);
            border-bottom-right-radius: 0; 
            display: flex; align-items: center; margin-bottom: 10px; max-width: 65px;
            align-self: flex-end; 
            margin-left: auto; 
            position: relative;
        }
        .typing-indicator::after {
            content: ""; position: absolute; bottom: 0; right: -8px; width: 0; height: 0;
            border-left: 10px solid #fff; 
            border-top: 10px solid transparent; border-bottom: 0 solid transparent;
        }

        .typing-indicator span {
            height: 8px; width: 8px; margin: 0 2px;
            display: block;
            border-radius: 50%;
            opacity: 1; 
            animation: typing 1s infinite;
        }
        .typing-indicator span:nth-of-type(1) {
            background-color: #9495EA; 
        }
        .typing-indicator span:nth-of-type(2) {
            background-color: #6B6F6E; 
            animation-delay: 0.2s;
        }
        .typing-indicator span:nth-of-type(3) {
            background-color: #84CD9D; 
            animation-delay: 0.4s;
        }

        @keyframes typing {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-5px); }
        }
        
        .chatbot-options {
            display: flex; flex-direction: column; gap: 10px; align-self: center;
            width: 90%; margin-top: 10px; margin-bottom: 10px;
        }

        .chatbot-option {
            position: relative; background-color: #fff; color: var(--text); padding: 8px; cursor: pointer;
            text-align: center; border-radius: 32px; transition: all 0.3s ease;
            border: none; z-index: 1; font-size: 14px;
            font-family: inherit; border: 1px solid #9495EA;
        }
        .chatbot-option:hover { background-color: #E9EAEA; }

        .chatbot-share-button {
            background-color: var(--secondary); 
            color: white ; 
            padding: 8px 16px; 
            cursor: pointer;
            text-align: center;
            border-radius: var(--border-radius-lg);
            transition: none; 
            border: none; 
            font-size: 14px;
            margin-top: 10px; 
            margin-bottom: 10px; 
            align-self: center; 
            width: fit-content; 
            display: block; 
        }

        .chatbot-action-button {
            background-color: var(--secondary); 
            color: white;
            padding: 8px 16px;
            cursor: pointer;
            text-align: center;
            border-radius: var(--border-radius-lg);
            transition: none; 
            border: none;
            font-size: 14px;
            display: inline-block; 
            margin: 5px 0; 
        }

        .chatbot-footer {
            padding: 16px; 
            border-top: 1px solid #eee; 
            display: flex; 
            background-color: #fff;
        }

        .chatbot-input {
            flex: 1;
            padding: 8px;
            border: 1px solid var(--secondary);
            border-radius: 16px 0 0 16px; 
            outline: none;
            margin-right: 0; 
            font-size: 14px; 
        }

        .chatbot-send {
            background-color: var(--secondary);
            color: white;
            border: none; 
            border-radius: 0 16px 16px 0; 
            padding: 8px 16px; 
            text-align: center;
            font-size: 18px; 
            cursor: pointer;
            transition: background-color 0.3s ease;
            flex-shrink: 0;
            display: inline-flex; 
            align-items: center;
            justify-content: center;
        }

        @media (max-width: 768px) {
            .chatbot-header:hover { background-color: var(--secondary); } 
            .chatbot-send:hover { background-color: var(--secondary); }   
            .chatbot-option { font-size: 14px;}
            .chatbot-option:hover { background-color: #fff; }

            .chatbot-icon:hover {
                animation: none;
            }
            .chatbot-container.chat-is-open .chatbot-icon {
                animation: chatbot-icon-morph 5s infinite;
            }
        }
    </style>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const chatbotContainer = document.getElementById('chatbot-container');
            const chatbotIcon = document.getElementById('chatbot-icon');
            const chatbotClose = document.getElementById('chatbot-close');
            const chatbotMessages = document.getElementById('chatbot-messages');
            const chatbotInput = document.getElementById('chatbot-input');
            const chatbotSend = document.getElementById('chatbot-send');
            const chatbotOpenSound = document.getElementById('chatbot-open-sound');

            let isFirstOpen = true;

            const optionsDefinition = {
                preregister: {
                    text: 'Voglio preregistrarmi all\'alpha',
                    action: () => {
                        const messageHTML = 'Ah, un visionario! 😎 (niente spam, giuriamo).<br>' +
                                            '<button class="chatbot-action-button" onclick="window.open(\'download.html\', \'_blank\');" style="margin-top: 10px; margin-bottom: 5px;">🔔 Preregistrati</button>';
                        addMessage(messageHTML, true);
                        setTimeout(() => {
                            askForMoreHelp([optionsDefinition.ideas, optionsDefinition.scroccone]);
                        }, 3500);
                    }
                },
                ideas: {
                    text: 'Ho delle idee geniali (forse 😅) da condividere',
                    action: () => {
                        addMessage('Oooh, mi piacciono le menti creative! 🧠 Spara pure le tue idee qui sotto — anche quelle strane (mai dire mai).', true);
                    }
                },
                scroccone: {
                    text: 'Ho un amico scroccone',
                    action: () => {
                        addMessage('Sai cosa sarebbe bellissimo? Che loro si iscrivessero, così puoi finalmente evitare la conversazione scomoda.', true);
                        setTimeout(() => {
                            const messageElement = document.createElement('div');
                            messageElement.classList.add('chatbot-message', 'bot-message', 'share-message');
                            const messageContent = document.createElement('div');
                            messageContent.innerHTML = 'Condividi il link, e lascia che ci pensiamo noi. 💌';
                            messageElement.appendChild(messageContent);
                            const shareButton = document.createElement('button');
                            shareButton.classList.add('chatbot-share-button');
                            shareButton.style.margin = '10px 0 5px 0';
                            shareButton.textContent = '🔗 Strush';
                            shareButton.onclick = async () => {
                                try {
                                    if (navigator.share) {
                                        await navigator.share({ title: 'Strush App', text: 'Dai un\'occhiata a questo!', url: 'https://www.strush.it' });
                                    } else {
                                        window.open('https://www.strush.it', '_blank');
                                    }
                                } catch (err) {
                                    window.open('https://www.strush.it', '_blank');
                                }
                            };
                            messageElement.appendChild(shareButton);
                            const typingIndicator = showTypingIndicator();
                            setTimeout(() => {
                                removeTypingIndicator();
                                chatbotMessages.appendChild(messageElement);
                                chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
                                setTimeout(() => {
                                    askForMoreHelp([optionsDefinition.preregister, optionsDefinition.ideas]);
                                }, 2000);
                            }, 1500);
                        }, 2000);
                    }
                }
            };
            
            function showTypingIndicator() {
                removeTypingIndicator();
                const typingIndicator = document.createElement('div');
                typingIndicator.classList.add('typing-indicator');
                typingIndicator.id = 'typing-indicator';
                for (let i = 0; i < 3; i++) {
                    typingIndicator.appendChild(document.createElement('span'));
                }
                chatbotMessages.appendChild(typingIndicator);
                chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
                return typingIndicator;
            }

            function removeTypingIndicator() {
                const typingIndicator = document.getElementById('typing-indicator');
                if (typingIndicator) typingIndicator.remove();
            }

            function addMessage(message, isBot = true) {
                removeTypingIndicator();
                const messageElement = document.createElement('div');
                messageElement.classList.add('chatbot-message');
                if (isBot) {
                    messageElement.classList.add('bot-message');
                    messageElement.innerHTML = message;
                    const typingIndicator = showTypingIndicator();
                    setTimeout(() => {
                        removeTypingIndicator();
                        chatbotMessages.appendChild(messageElement);
                        chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
                    }, 1500);
                } else {
                    messageElement.classList.add('user-message');
                    messageElement.textContent = message;
                    chatbotMessages.appendChild(messageElement);
                    chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
                }
            }

             function addOptions(options) {
                 const existingOptionsContainer = chatbotMessages.querySelector('.chatbot-options');
                 if (existingOptionsContainer) existingOptionsContainer.remove();
                 const standaloneShareButton = chatbotMessages.querySelector('button.chatbot-share-button:not([style*="margin"])');
                 if (standaloneShareButton && standaloneShareButton.parentElement === chatbotMessages) {
                     standaloneShareButton.remove();
                 }
                 const optionsContainer = document.createElement('div');
                 optionsContainer.classList.add('chatbot-options');
                 options.forEach(option => {
                     const optionElement = document.createElement('button');
                     optionElement.classList.add('chatbot-option');
                     optionElement.textContent = option.text;
                     optionElement.onclick = () => {
                         addMessage(option.text, false);
                         optionsContainer.remove();
                         option.action();
                     };
                     optionsContainer.appendChild(optionElement);
                 });
                 setTimeout(() => {
                      if (!chatbotMessages.querySelector('.chatbot-options')) {
                          chatbotMessages.appendChild(optionsContainer);
                          chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
                      }
                 }, 50);
             }

            function askForMoreHelp(optionsToShow) {
                 const existingOptionsContainer = chatbotMessages.querySelector('.chatbot-options');
                 if (existingOptionsContainer) existingOptionsContainer.remove();
                 setTimeout(() => {
                     addMessage('Posso aiutarti in altro?', true);
                     setTimeout(() => addOptions(optionsToShow), 1500);
                 }, 1500);
             }

            function showInitialOptions() {
                 addOptions([
                    optionsDefinition.preregister,
                    optionsDefinition.ideas,
                    optionsDefinition.scroccone
                ]);
            }

            function startConversation() {
                addMessage('Hey! Sono Dinuccio, il tuo compagno di viaggio in questa app ancora in cantiere 🏗️.<br>Come posso aiutarti?', true);
                setTimeout(showInitialOptions, 3500);
            }

            function playOpenSound() {
                chatbotOpenSound.currentTime = 0;
                let playPromise = chatbotOpenSound.play();
                if (playPromise !== undefined) {
                    playPromise.catch(() => {
                        document.body.addEventListener('click', () => chatbotOpenSound.play(), { once: true });
                    });
                }
            }

             function openChat() {
                 if (chatbotContainer.style.display === 'none') {
                     chatbotContainer.style.display = 'block'; 
                 }
                 if (!chatbotContainer.classList.contains('chat-is-open')) {
                     chatbotContainer.classList.add('chat-is-open');
                     if (isFirstOpen) {
                         playOpenSound();
                         isFirstOpen = false;
                         if (chatbotMessages.children.length === 0) {
                           startConversation();
                         }
                     }
                 }
             }

             function closeChat() {
                 chatbotContainer.classList.remove('chat-is-open');
             }

            let initialShowTimeout = setTimeout(() => {
                chatbotContainer.style.display = 'block'; 
                if (isFirstOpen) {
                    openChat(); 
                }
            }, 10000); 

            chatbotIcon.addEventListener('click', () => {
                 clearTimeout(initialShowTimeout); 
                 if (chatbotContainer.classList.contains('chat-is-open')) {
                    closeChat();
                 } else {
                     openChat();
                 }
             });

            chatbotClose.addEventListener('click', closeChat);

            function sendMessage() {
                const message = chatbotInput.value.trim();
                if (message !== '') {
                    addMessage(message, false);
                    const chatbotScriptURL = 'https://script.google.com/macros/s/AKfycbwDe9jThnMtPu5v8HRofqPInqyi7fLCHEFXPFQqnAEvTRpk-pYhwf76QRjQHEUiT66p/exec';
                    const formData = new FormData();
                    formData.append('Text', message);
                    fetch(chatbotScriptURL, { method: 'POST', mode: 'no-cors', body: formData });
                    chatbotInput.value = '';
                    const existingOptions = chatbotMessages.querySelector('.chatbot-options');
                    if (existingOptions) existingOptions.remove();
                    const standaloneShareButton = chatbotMessages.querySelector('button.chatbot-share-button:not([style*="margin"])');
                     if (standaloneShareButton && standaloneShareButton.parentElement === chatbotMessages) {
                        standaloneShareButton.remove();
                    }
                    setTimeout(() => {
                        addMessage('✅ Input ricevuto. Se non lo usiamo, è solo perché il mondo non è ancora pronto. 🌍', true);
                         askForMoreHelp([
                             optionsDefinition.preregister,
                             optionsDefinition.ideas,
                             optionsDefinition.scroccone
                         ]);
                    }, 1500);
                }
            }

            chatbotInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    sendMessage();
                }
            });
            chatbotSend.addEventListener('click', sendMessage);
        });
    </script>
</section>


    <!-- Cursore Animation Pallino viola + Blob-->
<div id="cursor-placeholder"></div>


    <!-- Navbar -->
<nav class="strush-navbar" id="mainNav">

    <div class="strush-container">
        <div class="strush-nav-container">
            <!-- Logo sempre visibile e centrato in mobile -->
            <div class="strush-logo-mobile">
                <a href="index.html#hero" class="strush-logo-container">
                    <div class="strush-logo">
                        <!-- Modificato per matchare forma iniziale chatbot -->
                        <div class="strush-logo-blob">
                            <img src="immagini/pittogramma.png" alt="Strush Logo">
                        </div>
                        <!-- NUOVA IMMAGINE LOGO TESTO -->
                        <img src="immagini/logo.png" alt="Strush" class="strush-logo-text-img">
                    </div>
                </a>
            </div>

            <!-- Menu hamburger a destra -->
            <div class="strush-menu-btn" id="menuBtn">
                <span></span>
                <span></span>
                <span></span>
            </div>

            <!-- Menu dropdown per mobile -->
            <div class="strush-mobile-dropdown" id="mobileDropdown">
                <ul class="strush-mobile-links">
                    <li><a href="index.html#features-mobile">Caratteristiche</a></li>
                    <li><a href="index.html#avatar-evolution">Avatar</a></li>
                    <li><a href="index.html#how-it-works">Tutorial</a></li>
                    <li><a href="index.html#testimonials">Testimonianze</a></li>
                    <li><a href="index.html#team">Team</a></li>
                </ul>
            </div>

            <!-- Menu desktop -->
            <div class="strush-nav-links-container" id="navLinksContainer">
                <!-- Logo per versione desktop -->
                <div class="strush-logo-nav-item">
                    <a href="index.html#hero" class="strush-logo-container">
                        <div class="strush-logo">
                             <!-- Modificato per matchare forma iniziale chatbot -->
                            <div class="strush-logo-blob">
                                <img src="immagini/pittogramma.png" alt="Strush Logo">
                            </div>
                            <!-- NUOVA IMMAGINE LOGO TESTO -->
                            <img src="immagini/logo.png" alt="Strush" class="strush-logo-text-img">
                        </div>
                    </a>
                </div>

                <ul class="strush-nav-links">
                    <li><a href="index.html#features-desktop">Caratteristiche</a></li>
                    <li><a href="index.html#avatar-evolution">Avatar</a></li>
                    <li><a href="index.html#how-it-works">Tutorial</a></li>
                    <li><a href="index.html#testimonials">Testimonianze</a></li>
                    <li><a href="index.html#team">Team</a></li>
                </ul>
            </div>
        </div>
    </div>

    <style>
        /* Namespace all selectors with 'strush-' prefix to prevent conflicts */
        .strush-navbar {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 999; /* Navbar sopra il dropdown */
            padding: 0;
            transition: all 0.3s ease;
            background-color: #121212;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            min-height: 70px;
            display: flex;
            align-items: center;
        }

        body {
            padding-top: var(--nav-height, 70px);
        }

        .strush-container {
            width: 96%;
            max-width: 1140px;
            margin: 0 auto;
            padding: 0;
            width: 100%;
        }

        .strush-nav-container {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            padding: 4px 0;
            position: relative;
            min-height: 60px;
        }

        /* --- LOGO MOBILE --- */
        .strush-logo-mobile {
            display: none;
        }

        .strush-logo-mobile .strush-logo-blob {
            width: 0;
            height: 38px;
            opacity: 0;
            margin-right: 0;
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: width 0.3s ease, opacity 0.3s ease, margin-right 0.3s ease;
            overflow: hidden;
            border-radius: 60% 40% 65% 35% / 35% 65% 35% 65%;
            background: linear-gradient(135deg, #84CD9D 0%, #9495EA 100%);
            padding: 2px;
            box-sizing: border-box;
        }
        .strush-logo-mobile .strush-logo-blob img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
            border-radius: inherit;
        }

        .strush-logo-mobile .strush-logo-text-img {
             height: 24px;
             width: auto;
             display: inline-block;
             vertical-align: middle;
             margin-left: 0;
             transition: opacity 0.3s ease, transform 0.3s ease, width 0.3s ease, margin-left 0.3s ease;
             opacity: 1;
        }
        /* --- FINE LOGO MOBILE --- */


        /* Dropdown mobile styles */
        .strush-mobile-dropdown {
            display: none;
            position: absolute;
            top: 70px; /* Default top position */
            left: 0;
            width: 100%;
            background-color: #121212;
            backdrop-filter: blur(15px); /* Per desktop */
            -webkit-backdrop-filter: blur(15px); /* Per desktop */
            z-index: 998; /* Dropdown sotto la navbar */
            transition: opacity 0.4s ease, transform 0.4s ease, max-height 0.4s ease;
            padding: 16px 0;
            border-radius: 0 0 16px 16px;
            transform: translateY(-20px);
            opacity: 0;
            height: auto;
            max-height: 0;
            overflow: hidden;
        }

        .strush-mobile-dropdown::after {
            content: '';
            position: absolute;
            top: -30px;
            left: -30px;
            right: -30px;
            bottom: -30px;
            /* MODIFICA: Ridotta opacità dei colori nel gradiente */
            background: radial-gradient(ellipse at center, rgba(140, 141, 212, 0.1) 0%, rgba(142, 220, 169, 0.05) 40%, rgba(10, 10, 15, 0) 75%);
            /* MODIFICA: Ridotta sfocatura per desktop */
            filter: blur(25px); /* Era 35px */
            z-index: -1;
            opacity: 0;
            transition: opacity 0.6s ease 0.2s;
            pointer-events: none;
            border-radius: 50%;
        }
        .strush-mobile-dropdown.active { transform: translateY(0); opacity: 1; max-height: 400px;}
        .strush-mobile-dropdown.active::after { opacity: 1; } /* Potresti anche ridurre questa opacità se vuoi, es. opacity: 0.7; */
        .strush-mobile-links { list-style: none; padding: 0; margin: 0; display: flex; flex-direction: column; align-items: center; position: relative; z-index: 1; }
        .strush-mobile-links li { margin: 8px 0; width: 100%; text-align: center; opacity: 0; transform: translateY(-10px); transition: opacity 0.3s ease, transform 0.3s ease; transition-delay: calc(0.05s * var(--i, 0)); }
        .strush-mobile-dropdown.active .strush-mobile-links li { opacity: 1; transform: translateY(0); transition-delay: calc(0.2s + (0.05s * var(--i, 0))); }
        .strush-mobile-links a { text-decoration: none; color: white; font-size: 18px; padding: 12px 20px; display: block; width: 100%; max-width: 250px; margin: 0 auto; border-radius: 16px; transition: all 0.3s ease; position: relative; text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5); }
        .strush-mobile-links a:hover { color: #84CD9D; background-color: rgba(255, 255, 255, 0.05); }

        /* Stili Desktop Navbar */
        .strush-nav-links-container { display: flex; justify-content: center; align-items: center; flex-wrap: nowrap; transition: all 0.3s ease; width: auto; padding: 8px; border-radius: 32px; margin: 0; position: relative; }
        .strush-nav-links-container:hover { background-image: linear-gradient( 90deg, rgba(30, 30, 40, 0.8) 0%, rgba(80, 80, 110, 0.9) 25%, rgba(177, 172, 250, 0.2) 50%, rgba(80, 80, 110, 0.9) 75%, rgba(30, 30, 40, 0.8) 100% ); background-size: 200% 100%; animation: strush-shimmerBackground 3s linear infinite; }

        .strush-logo-nav-item {
            margin-right: 15px;
            transition: margin-right 0.3s ease;
            flex-shrink: 0;
            display: flex;
            align-items: center;
        }
        .strush-logo-container { text-decoration: none; display: flex; align-items: center; }
        .strush-logo { display: flex; align-items: center; }

        /* --- LOGO DESKTOP --- */
        .strush-logo-nav-item .strush-logo-blob {
            width: 0;
            height: 38px;
            opacity: 0;
            transform: scale(0.7);
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-right: 0px;
            overflow: hidden;
            border-radius: 60% 40% 65% 35% / 35% 65% 35% 65%;
            background: linear-gradient(135deg, #84CD9D 0%, #9495EA 100%);
            padding: 2px;
            box-sizing: border-box;
            transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out, width 0.3s ease-in-out;
        }
        .strush-logo-nav-item .strush-logo-blob img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
            border-radius: inherit;
        }

        .strush-logo-nav-item .strush-logo-text-img {
            height: 20px;
            width: auto;
            display: inline-block;
            vertical-align: middle;
            margin-right: 8px;
            opacity: 1;
            transform: scale(1);
            transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out, width 0.3s ease-in-out 0.05s, margin-left 0.3s ease-in-out;
        }

        .strush-nav-links-container:hover .strush-logo-nav-item .strush-logo-blob {
            width: 38px;
            opacity: 1;
            transform: scale(1);
            margin-right: 5px;
            animation: navbar-blob-morph-from-chatbot 5s infinite;
        }
        .strush-nav-links-container:hover .strush-logo-nav-item .strush-logo-text-img {
            opacity: 0;
            transform: scale(0.7);
            width: 0;
            overflow: hidden;
            pointer-events: none;
            margin-left: 0;
            margin-right: 0;
        }

        .strush-nav-links-container:hover .strush-logo-nav-item {
            margin-right: 5px;
        }
        /* --- FINE LOGO DESKTOP --- */


        @keyframes strush-shimmerBackground { 0% { background-position: -100% 0; } 100% { background-position: 200% 0; } }

        @keyframes navbar-blob-morph-from-chatbot {
        0%  { border-radius: 60% 40% 65% 35% / 35% 65% 35% 65%; transform: rotate(0deg) scale(var(--blob-scale, 1)); }
        15% { border-radius: 55% 45% 70% 30% / 45% 55% 45% 55%; transform: rotate(4deg) scale(var(--blob-scale, 1)); }
        30% { border-radius: 41% 59% 27% 73% / 58% 28% 72% 42%; transform: rotate(9deg) scale(var(--blob-scale, 1)); }
        45% { border-radius:  60% 40% 50% 50% / 35% 65% 35% 65%; transform: rotate(4deg) scale(var(--blob-scale, 1)); }
        60% { border-radius: 55% 45% 35% 65% / 55% 45% 55% 45%; transform: rotate(-9deg) scale(var(--blob-scale, 1)); }
        75% { border-radius: 30% 70% 50% 50% / 60% 40% 60% 40%; transform: rotate(-12deg) scale(var(--blob-scale, 1)); }
        90% { border-radius: 60% 40% 70% 30% / 40% 60% 40% 60%; transform: rotate(-1deg) scale(var(--blob-scale, 1)); }
        100% { border-radius: 60% 40% 65% 35% / 35% 65% 35% 65%; transform: rotate(0deg) scale(var(--blob-scale, 1));}
        }

        .strush-nav-links-container:hover .strush-logo-nav-item .strush-logo-blob,
        .menu-active .strush-logo-mobile .strush-logo-blob {
            --blob-scale: 1;
        }
        .strush-logo-nav-item .strush-logo-blob {
             --blob-scale: 0.7;
        }

        .strush-logo-mobile .strush-logo-blob {
            --blob-scale: 1;
        }

        .strush-nav-links { display: flex; list-style: none; margin: 0; padding: 0; flex-wrap: nowrap; }
        .strush-nav-links li { margin: 0 4px; }
        .strush-nav-links a {
            text-decoration: none;
            color: white;
            font-weight: 500;
            font-size: 14px;
            padding: 8px 8px;
            border-radius: 16px;
            transition: all 0.3s ease;
            position: relative;
            display: inline-block;
            white-space: nowrap;
        }
        .strush-nav-links a:hover {
            color: #84CD9D;
        }
        .strush-nav-links a::after {
            content: '';
            position: absolute;
            bottom: 0px;
            left: 50%;
            width: 0;
            height: 2px;
            background: linear-gradient(to right, #84CD9D, #9495EA);
            transition: width 0.3s ease;
            transform: translateX(-50%);
            border-radius: 32px;
        }
        .strush-nav-links a:hover::after {
            width: calc(100% - 16px);
        }
        .strush-menu-btn { display: none; cursor: pointer; z-index: 999; }
        .strush-menu-btn span { display: block; width: 25px; height: 3px; background-color: white; margin: 5px 0; transition: all 0.3s ease; }
        .strush-menu-btn.open span:nth-child(1), .strush-menu-btn.active span:nth-child(1) { transform: rotate(45deg) translate(5px, 6px); }
        .strush-menu-btn.open span:nth-child(2), .strush-menu-btn.active span:nth-child(2) { opacity: 0; }
        .strush-menu-btn.open span:nth-child(3), .strush-menu-btn.active span:nth-child(3) { transform: rotate(-45deg) translate(5px, -6px); }

        /* Media query unificata per dispositivi mobili */
        @media screen and (max-width: 768px) {
            .strush-navbar {
                backdrop-filter: none;
                -webkit-backdrop-filter: none;
                height: 70px;
                min-height: 70px;
                display: flex;
                align-items: center;
            }
            .strush-nav-container { display: grid; grid-template-columns: 1fr auto 1fr; padding: 0; height: 70px; align-items: center; justify-content: space-between; }

            .strush-logo-mobile {
                display: block;
                z-index: 999;
                grid-column: 2;
                text-align: center;
                padding: 0 15px;
                margin-top: 0;
            }

            .menu-active .strush-logo-mobile .strush-logo-text-img {
                opacity: 0;
                width: 0;
                margin-left: 0;
                overflow: hidden;
                pointer-events: none;
            }

            .menu-active .strush-logo-mobile .strush-logo-blob {
                width: 38px;
                height: 38px;
                opacity: 1;
                animation: navbar-blob-morph-from-chatbot 5s infinite;
            }

            .menu-active .strush-logo-mobile .strush-logo {
                justify-content: center;
            }

            .strush-nav-links-container { display: none; }

            .strush-mobile-dropdown {
                display: block;
                top: 69px; 
                backdrop-filter: none;
                -webkit-backdrop-filter: none;
            }
            .strush-mobile-dropdown::after {
                /* MODIFICA: Ridotta sfocatura per mobile e estensione */
                filter: blur(20px); /* Era 25px, originariamente 35px */
                top: -15px;         /* Era -20px, originariamente -30px */
                left: -15px;
                right: -15px;
                bottom: -15px;
                /* L'opacità del gradiente è già stata ridotta nella regola generale di .strush-mobile-dropdown::after */
            }
            .strush-menu-btn { display: block; z-index: 999; grid-column: 3; justify-self: end; margin-right: 10px; }
            .strush-menu-btn.open span, .strush-menu-btn.active span { background-color: #9495EA; }
            .strush-container { width: 100%; max-width: 1140px; padding: 0 15px; box-sizing: border-box; }
        }
    </style>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const menuBtn = document.getElementById('menuBtn');
            const mobileDropdown = document.getElementById('mobileDropdown');
            const mobileLinks = document.querySelectorAll('.strush-mobile-links li a');
            const navbar = document.getElementById('mainNav');

            function updateNavbarHeight() {
                const navbarHeight = navbar ? navbar.offsetHeight : 70;
                document.documentElement.style.setProperty('--nav-height', navbarHeight + 'px');
                document.body.style.paddingTop = navbarHeight + 'px';
            }
            updateNavbarHeight();

            document.querySelectorAll('.strush-mobile-links li').forEach((item, index) => {
                item.style.setProperty('--i', index);
            });

            menuBtn.addEventListener('click', function(e) {
                e.stopPropagation();
                menuBtn.classList.toggle('open');
                menuBtn.classList.toggle('active');
                mobileDropdown.classList.toggle('active');
                document.body.classList.toggle('menu-active');
            });

            mobileLinks.forEach(link => {
                link.addEventListener('click', function() {
                    menuBtn.classList.remove('open');
                    menuBtn.classList.remove('active');
                    mobileDropdown.classList.remove('active');
                    document.body.classList.remove('menu-active');
                });
            });

            document.addEventListener('click', function(e) {
                if (mobileDropdown.classList.contains('active') &&
                    !mobileDropdown.contains(e.target) &&
                    !menuBtn.contains(e.target)) {
                    menuBtn.classList.remove('open');
                    menuBtn.classList.remove('active');
                    mobileDropdown.classList.remove('active');
                    document.body.classList.remove('menu-active');
                }
            });

            window.addEventListener('scroll', function() {
                if (window.scrollY > 50) {
                    navbar.classList.add('scrolled');
                } else {
                    navbar.classList.remove('scrolled');
                }
            });

            let resizeTimerNav;
            window.addEventListener('resize', () => {
                clearTimeout(resizeTimerNav);
                resizeTimerNav = setTimeout(updateNavbarHeight, 150);
            }, { passive: true });
        });
    </script>

    <!-- Inizio Blocco Curva Navbar con Barra di Lettura -->
    <div class="navbar-bottom-curve">
        <svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 200 30"
            preserveAspectRatio="none"
            style="display: block; width: 100%; height: 100%;"
            version="1.1"
            xmlns:xlink="http://www.w3.org/1999/xlink"
            class="curve-svg"
            >
        <!-- MODIFICA: Trasformazione applicata a un gruppo <g> interno -->
        <g transform="matrix(1,0,0,-1,0,30)">
            <defs>
                <mask id="uniqueCurveMask">
                <rect x="0" y="0" width="200" height="30" fill="white" class="mask-rect"></rect>
                <!-- Questo path e le coordinate sono relative al sistema pre-trasformazione del <g> -->
                <!-- (0,0) è l'angolo in alto a sinistra del <g>, Y cresce verso il basso) -->
                <path d="M0,0 L200,0 A100,30 0 0 1 0,0 Z" fill="black" class="mask-path"></path>
                </mask>
            </defs>
            <!-- Rettangolo colorato principale, mascherato per creare la curva piena -->
            <!-- y="0.5" significa 0.5px dal top del <g> pre-trasformazione -->
            <rect x="0" y="0.5" width="200" height="29.5" fill="#121212" mask="url(#uniqueCurveMask)" class="main-rect"></rect>

            <!-- Path per la barra di progresso (solo l'arco) -->
            <!-- Disegnato da sinistra (0,0) a destra (200,0) nel sistema pre-trasformazione del <g> -->
            <path
                id="readingProgressCurve"
                class="progress-bar-path"
                d="M0,0 A100,30 0 0 0 200,0"
                ></path>
        </g>
        </svg>
    </div>

    <style>
        .navbar-bottom-curve {
            position: fixed;
            top: 69px; /* Assicurati che questo valore sia corretto per la tua navbar */
            left: 0;
            width: 100%;
            height: 30px; /* Altezza desktop */
            z-index: 999;
            background-color: transparent; /* Importante che sia trasparente */
            pointer-events: none; /* Non intercetta eventi mouse sul contenitore */
        }

        .curve-svg {
            display: block;
            width: 100%;
            height: 100%;
        }

        .progress-bar-path {
            fill: none;
            stroke: #9495EA; /* Colore della barra di progresso, personalizzabile */
            stroke-width: 3; /* Spessore desktop in unità SVG */
            stroke-linecap: round;
            transition: stroke-dashoffset 0.05s linear; /* Transizione fluida */
            pointer-events: auto;
        }

        @media screen and (max-width: 767px) {
            .navbar-bottom-curve {
                height: 25px; /* Altezza mobile */
                width: calc(100% + 1px);
                left: -0.5px;
            }
            .progress-bar-path {
                /* Per mantenere ~3px visivi quando l'SVG è alto 25px (contenitore)
                ma la viewBox SVG è alta 30 unità:
                stroke-width-svg = (3px_desiderati / 25px_altezza_reale_contenitore) * 30_altezza_viewbox
                                    = (3 / 25) * 30 = 0.12 * 30 = 3.6
                */
                stroke-width: 3.6; /* Spessore mobile in unità SVG */
            }
        }
    </style>

    <script>
        (function() { // IIFE per incapsulare lo scope ed evitare conflitti
            const progressBarPath = document.getElementById('readingProgressCurve');

            if (!progressBarPath) {
                // console.error("Elemento 'readingProgressCurve' per la barra di progresso non trovato!");
                return;
            }

            let pathLength;

            function calculatePathLength() {
                try {
                    pathLength = progressBarPath.getTotalLength();
                    progressBarPath.style.strokeDasharray = pathLength;
                    progressBarPath.style.strokeDashoffset = pathLength; // Inizia vuota
                } catch (e) {
                    // console.error("Errore nel calcolare getTotalLength:", e);
                }
            }

            function updateProgressBar() {
                if (typeof pathLength === 'undefined' || pathLength === 0) {
                    calculatePathLength();
                    if (typeof pathLength === 'undefined' || pathLength === 0) return;
                }

                const scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
                const scrollHeight = document.documentElement.scrollHeight || document.body.scrollHeight;
                const clientHeight = document.documentElement.clientHeight;
                const scrollableHeight = scrollHeight - clientHeight;

                if (scrollableHeight <= 0) {
                    progressBarPath.style.strokeDashoffset = pathLength;
                    return;
                }

                const scrollPercentage = scrollTop / scrollableHeight;
                const drawLength = pathLength * scrollPercentage;
                progressBarPath.style.strokeDashoffset = Math.max(0, Math.min(pathLength, pathLength - drawLength));
            }

            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', function() {
                    calculatePathLength();
                    updateProgressBar(); // Imposta lo stato iniziale
                });
            } else {
                calculatePathLength();
                updateProgressBar(); // Imposta lo stato iniziale
            }

            window.addEventListener('scroll', updateProgressBar, { passive: true });

            let resizeTimeout;
            window.addEventListener('resize', function() {
                clearTimeout(resizeTimeout);
                resizeTimeout = setTimeout(function() {
                    calculatePathLength();
                    updateProgressBar();
                }, 100); // Debounce leggero
            });

        })();
    </script>
<!-- Fine Blocco Curva Navbar con Barra di Lettura -->

</nav>



    <!-- Hero Section -->
<section class="hero" id="hero">

    <div class="container">
        <div class="hero-content">
            <h1 class="hero-title">I soldi non crescono sugli alberi</h1>
            <p class="hero-subtitle">Spese pazze o amico fantasma al conto?<br>Con Strush si gioca sul serio</p>
            <div class="hero-buttons">
                <a href="#features-desktop" class="btn btn-secondary" id="discover-more-btn">Scopri di più</a>
                <a href="#download" class="btn btn-primary">Scarica ora</a>
            </div>
        </div>
        <div class="hero-image">
            <!-- Nessun overflow: hidden qui -->
            <div class="dino-avatar-container">
                <div class="dino-character">
                    <div class="dino-body">
                        <div class="dino-head">
                            <div class="dino-eye"></div>
                            <div class="dino-snout"></div>
                            <div class="dino-mouth"></div>
                        </div>
                        <div class="dino-neck"></div>
                        <div class="dino-torso"></div>
                        <div class="dino-arm left"></div>
                        <div class="dino-arm right"></div>
                        <div class="dino-leg left"></div>
                        <div class="dino-leg right"></div>
                        <div class="dino-tail"></div>
                        <div class="dino-spikes">
                            <div class="spike s1"></div>
                            <div class="spike s2"></div>
                            <div class="spike s3"></div>
                            <div class="spike s4"></div>
                            <div class="spike s5"></div>
                        </div>
                    </div>
                </div>

                <div class="tech-overlay">
                    <div class="data-point p1"></div>
                    <div class="data-point p2"></div>
                    <div class="data-point p3"></div>
                    <div class="data-point p4"></div>
                    <div class="data-point p5"></div>
                    <div class="data-point p6"></div>
                    <div class="scan-line"></div>
                    <div class="tech-circle c1"></div>
                    <div class="tech-circle c2"></div>
                    <div class="tech-circle c3"></div>
                </div>

                <div class="particles">
                    <div class="particle p1"></div>
                    <div class="particle p2"></div>
                    <div class="particle p3"></div>
                    <div class="particle p4"></div>
                    <div class="particle p5"></div>
                    <div class="particle p6"></div>
                    <div class="particle p7"></div>
                    <div class="particle p8"></div>
                </div>

                <div class="prehistoric-bg">
                    <div class="mountain m1"></div>
                    <div class="mountain m2"></div>
                    <div class="mountain m3"></div>
                    <div class="tree t1"></div>
                    <div class="tree t2"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="scroll-indicator">
        <div class="mouse">
            <div class="wheel"></div>
        </div>
        <div class="arrow">
            <span></span>
            <span></span>
            <span></span>
        </div>
    </div>

    <style>
        /* --- MODIFICA CHIAVE --- */
        html {
            overflow-x: clip; /* Impedisce l'overflow orizzontale a livello radice */
        }
        /* --- FINE MODIFICA CHIAVE --- */

        html, body {
            margin: 0;
            padding: 0;
        }

        body {
            /* overflow-x: hidden; */
            overflow-y: auto;
        }

        .hero {
            position: relative;
            /* MODIFICA: Usa l'altezza minima della viewport (svh) per evitare il riadattamento */
            height: calc(100svh - var(--nav-height, 70px));
            /* Opzionale: Aggiungere min-height per maggiore robustezza */
            min-height: calc(100svh - var(--nav-height, 70px));
            width: 100%;
            margin: 0;
            padding: 0;
            display: flex;
            align-items: center;
            background: #121212;
            box-sizing: border-box;
        }


        .hero .container {
            position: relative;
            z-index: 1;
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: 100%; /* Occupa l'intera altezza calcolata del genitore .hero */
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
            box-sizing: border-box;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect width="100%" height="100%" fill="none"/><circle cx="10" cy="10" r="1" fill="%23B1ACFA" opacity="0.3"/><circle cx="30" cy="30" r="1" fill="%23B1ACFA" opacity="0.3"/><circle cx="50" cy="50" r="1" fill="%23B1ACFA" opacity="0.3"/><circle cx="70" cy="70" r="1" fill="%23B1ACFA" opacity="0.3"/><circle cx="90" cy="90" r="1" fill="%23B1ACFA" opacity="0.3"/><circle cx="10" cy="30" r="1" fill="%23B1ACFA" opacity="0.3"/><circle cx="30" cy="50" r="1" fill="%23B1ACFA" opacity="0.3"/><circle cx="50" cy="70" r="1" fill="%23B1ACFA" opacity="0.3"/><circle cx="70" cy="90" r="1" fill="%23B1ACFA" opacity="0.3"/><circle cx="90" cy="10" r="1" fill="%23B1ACFA" opacity="0.3"/></svg>');
            opacity: 0.1;
            z-index: 0;
        }

        .hero::after {
            content: '';
            position: absolute;
            bottom: -29px;
            left: 0;
            width: 100%;
            height: 30px;
            background: inherit;
            border-radius: 0 0 50% 50% / 0 0 100% 100%;
            z-index: 2;
            pointer-events: none;
        }

        .hero-content {
            width: 50%;
            color: white;
            padding-right: 30px;
            animation: fadeInUp 1s ease-out;
            box-sizing: border-box;
            position: relative;
            z-index: 1;
        }

        h1.hero-title {
            margin-bottom: 24px;
            line-height: 1.2;
            background: linear-gradient(135deg, #84CD9D 0%, #9495EA 100%);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            background-color: transparent; /* <<<--- AGGIUNTO QUESTO */
text-shadow: 0 0px 20px #9495EA33;
        }

        .hero-subtitle {
            margin-bottom: 32px;
            color: #ffffff;
            font-size: 20px;

        }

        .hero-buttons {
            display: flex;
            gap: 30px;
            align-items: center;
        }

        .btn {
            display: inline-block;
            padding: 16px;
            border-radius: 32px;
            font-weight: 500;
            text-decoration: none;
            transition: all 0.3s ease;
            font-size: 20px;
            text-align: center;
            border: 2px solid transparent;
        }

        .btn-primary {
            background: var(--secondarygradient);
            color: white;
            width: 190px;

        }

        .btn-primary:hover {
            box-shadow: 0 2px 8px #9495EA40;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: transparent;
            color: #9495EA;
            border: 1px solid var(--secondary);
            width: 190px;
        }

        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 2px 8px #9495EA40;
        }

        .hero-image {
            width: 45%;
            position: relative;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: fadeInRight 1s ease-out;
            box-sizing: border-box;
            z-index: 1;
        }

        .dino-avatar-container {
            position: relative;
            width: 100%;
            height: 70%;
            display: flex;
            justify-content: center;
            align-items: center;
            perspective: 1200px;
            transform-style: preserve-3d;
        }

        .dino-character {
            position: relative;
            width: 280px;
            height: 280px;
            transform-style: preserve-3d;
            animation: dinoFloat 4s infinite ease-in-out;
            z-index: 10;
        }

        .dino-character::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 100%;
            height: 100%;
            transform: translate(-50%, -50%);
            background: radial-gradient(circle, rgba(177, 172, 250, 0.2) 0%, transparent 70%);
            border-radius: 50%;
            filter: blur(20px);
            z-index: -1;
            animation: glowPulse 3s infinite;
        }

        .dino-body { position: relative; width: 100%; height: 100%; transform-style: preserve-3d; }
        .dino-head { position: absolute; top: 40px; left: 170px; width: 90px; height: 70px; background: #67AF9E; border-radius: 50% 70% 30% 30%; transform: rotate(10deg); z-index: 5; animation: dinoHead 5s infinite alternate; }
        .dino-eye { position: absolute; top: 20px; left: 20px; width: 18px; height: 18px; background: white; border-radius: 50%; overflow: hidden; }
        .dino-eye::after { content: ''; position: absolute; top: 4px; left: 4px; width: 10px; height: 10px; background: #121212; border-radius: 50%; animation: dinoEye 4s infinite; }
        .dino-snout { position: absolute; top: 35px; left: 45px; width: 50px; height: 25px; background: #5DA08F; border-radius: 60% 80% 60% 40%; transform: rotate(-5deg); }
        .dino-mouth { position: absolute; top: 45px; left: 55px; width: 30px; height: 10px; background: #4A8272; border-radius: 40% 40% 60% 60%; animation: dinoMouth 3s infinite; }
        .dino-neck { position: absolute; top: 90px; left: 150px; width: 50px; height: 70px; background: #67AF9E; border-radius: 30% 30% 50% 50%; transform: rotate(60deg); z-index: 4; }
        .dino-torso { position: absolute; top: 120px; left: 80px; width: 120px; height: 80px; background: #67AF9E; border-radius: 50% 40% 40% 50%; z-index: 3; }
        .dino-arm { position: absolute; width: 35px; height: 50px; background: #5DA08F; border-radius: 40% 40% 20% 20%; z-index: 2; }
        .dino-arm.left { top: 136px; left: 190px; height: 6%; transform: rotate(-30deg); transform-origin: top center; animation: dinoArmRight 3s infinite alternate; } /* Corretto nome animazione */
        .dino-arm.right { top: 130px; left: 140px; transform: rotate(-10deg); animation: dinoArmRight 3s infinite alternate; }
        .dino-leg { position: absolute; width: 30px; height: 60px; background: #5DA08F; border-radius: 30% 30% 20% 20%; z-index: 1; }
        .dino-leg.left { top: 180px; left: 95px; animation: dinoLegLeft 3s infinite alternate; }
        .dino-leg.right { top: 180px; left: 145px; animation: dinoLegRight 3s infinite alternate; }
        .dino-tail { position: absolute; top: 140px; left: 20px; width: 100px; height: 30px; background: #67AF9E; border-radius: 30% 30% 30% 30%; transform: rotate(-10deg); z-index: 2; animation: dinoTail 4s infinite alternate; }
        .dino-spikes { position: absolute; top: 80px; left: 66px; width: 140px; height: 40px; z-index: 6; transform: rotate(0deg); }
        .spike { position: absolute; width: 18px; height: 25px; background: #84C7B6; border-radius: 50% 50% 0 0; transform-origin: bottom center; }
        .spike.s1 { left: 0; top: 38px; animation: spikeWave 3s infinite ease-in-out; }
        .spike.s2 { left: 28.5px; top: 27px; animation: spikeWave 3s infinite ease-in-out 0.2s; }
        .spike.s3 { left: 57px; top: 19px; animation: spikeWave 3s infinite ease-in-out 0.4s; }
        .spike.s4 { left: 83px; top: 10px; animation: spikeWave 3s infinite ease-in-out 0.6s; }
        .spike.s5 { left: -28px; top: 45px; animation: spikeWave 3s infinite ease-in-out 0.8s; }

        .tech-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 20; }
        .data-point { position: absolute; width: 10px; height: 10px; background: rgba(177, 172, 250, 0.7); border-radius: 50%; box-shadow: 0 4px 10px #9495EA66;
            opacity: 0; animation: dataPoint 4s infinite; }
        .data-point.p1 { top: 60px; left: 200px; animation-delay: 0.5s; }
        .data-point.p2 { top: 120px; left: 170px; animation-delay: 1.0s; }
        .data-point.p3 { top: 150px; left: 100px; animation-delay: 1.5s; }
        .data-point.p4 { top: 200px; left: 120px; animation-delay: 2.0s; }
        .data-point.p5 { top: 80px; left: 100px; animation-delay: 2.5s; }
        .data-point.p6 { top: 180px; left: 60px; animation-delay: 3.0s; }
        .scan-line { position: absolute; top: 0; left: 0; width: 100%; height: 2px; background: rgba(177, 172, 250, 0.5); box-shadow: 0 0px 10px #9495EA66;animation: scanLine 3s infinite; }
        .tech-circle { position: absolute; border: 1px solid rgba(177, 172, 250, 0.5); border-radius: 50%; box-shadow: 0 0 15px rgba(177, 172, 250, 0.3);box-shadow: 0 0px 10px #9495EA66;opacity: 0.7; animation: techCirclePulse 4s infinite; }
        .tech-circle.c1 { top: 50%; left: 50%; width: 300px; height: 300px; transform: translate(-50%, -50%); }
        .tech-circle.c2 { top: 50%; left: 50%; width: 400px; height: 400px; transform: translate(-50%, -50%); animation-delay: 0.5s; }
        .tech-circle.c3 { top: 50%; left: 50%; width: 500px; height: 500px; transform: translate(-50%, -50%); animation-delay: 1s; }

        .particles { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 5; }
        .particle { position: absolute; width: 5px; height: 5px; background: rgba(177, 172, 250, 0.6); border-radius: 50%; filter: blur(1px); opacity: 0; animation: particleFloat 5s infinite linear; }
        .particle.p1 { top: 20%; left: 10%; animation-delay: 0.2s; }
        .particle.p2 { top: 70%; left: 20%; animation-delay: 0.7s; }
        .particle.p3 { top: 40%; left: 80%; animation-delay: 1.2s; }
        .particle.p4 { top: 60%; left: 70%; animation-delay: 1.7s; }
        .particle.p5 { top: 30%; left: 30%; animation-delay: 2.2s; }
        .particle.p6 { top: 80%; left: 40%; animation-delay: 2.7s; }
        .particle.p7 { top: 10%; left: 60%; animation-delay: 3.2s; }
        .particle.p8 { top: 50%; left: 90%; animation-delay: 3.7s; }

        .prehistoric-bg { position: absolute; bottom: 15%; left: 0; width: 100%; height: 30%; z-index: 1; }
        .mountain { position: absolute; bottom: 0; background: #2A3B37; clip-path: polygon(50% 0%, 100% 100%, 0% 100%); }
        .mountain.m1 { left: 10%; width: 130px; height: 100px; opacity: 0.7; }
        .mountain.m2 { left: 30%; width: 200px; height: 150px; opacity: 0.5; }
        .mountain.m3 { right: 20%; width: 180px; height: 120px; opacity: 0.6; }
        .tree { position: absolute; bottom: 0; }
        .tree.t1 { left: 70%; width: 30px; height: 80px; background: #2A3B37; border-radius: 50% 50% 0 0; opacity: 0.7; }
        .tree.t2 { left: 30%; width: 40px; height: 100px; background: #2A3B37; border-radius: 50% 50% 0 0; opacity: 0.6; }

        .energy-wave { position: absolute; width: 10px; height: 10px; border-radius: 50%; background: transparent; border: 2px solid rgba(177, 172, 250, 0.8); box-shadow: 0 4px 10px #9495EA66;
            transform: translate(-50%, -50%); animation: energyWave 1s forwards; z-index: 30; pointer-events: none; }

        .scroll-indicator { position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%); display: flex; flex-direction: column; align-items: center; color: rgba(255, 255, 255, 0.6); animation: fadeInUp 1s ease-out 1s both; z-index: 50; }
        .mouse { width: 26px; height: 40px; border: 2px solid #E9EAEA; border-radius: 20px; position: relative; margin-bottom: 10px; }
        .wheel { position: absolute; top: 7px; left: 50%; transform: translateX(-50%); width: 4px; height: 8px; background:#E9EAEA; border-radius: 2px; animation: scroll 2s infinite; }
        .arrow { display: flex; flex-direction: column; align-items: center; gap: 3px; }
        .arrow span { display: block; width: 10px; height: 10px; border-right: 2px solid rgba(255, 255, 255, 0.6); border-bottom: 2px solid #E9EAEA; transform: rotate(45deg); animation: arrow 2s infinite; }
        .arrow span:nth-child(2) { animation-delay: 0.2s; }
        .arrow span:nth-child(3) { animation-delay: 0.4s; }

        /* --- Keyframes (rimangono invariati) --- */
        @keyframes dinoFloat { 0%, 100% { transform: translateY(0) rotate(2deg); } 50% { transform: translateY(-15px) rotate(-2deg); } }
        @keyframes dinoHead { 0%, 100% { transform: rotate(10deg); } 50% { transform: rotate(15deg); } }
        @keyframes dinoEye { 0%, 100% { transform: translate(0, 0); } 25% { transform: translate(2px, 0); } 50% { transform: translate(0, 1px); } 75% { transform: translate(-1px, 0); } }
        @keyframes dinoMouth { 0%, 90%, 100% { height: 10px; } 95% { height: 15px; } }
        @keyframes dinoArmLeft { 0%, 100% { transform: rotate(10deg); } 50% { transform: rotate(20deg); } }
        @keyframes dinoArmRight { 0%, 100% { transform: rotate(-10deg); } 50% { transform: rotate(-25deg); } }
        @keyframes dinoLegLeft { 0%, 100% { transform: rotate(0); } 50% { transform: rotate(5deg); } }
        @keyframes dinoLegRight { 0%, 100% { transform: rotate(0); } 50% { transform: rotate(-5deg); } }
        @keyframes dinoTail { 0%, 100% { transform: rotate(-10deg); } 50% { transform: rotate(-20deg); } }
        @keyframes spikeWave { 0%, 100% { transform: rotate(0); } 50% { transform: rotate(-15deg); } }
        @keyframes dataPoint { 0% { transform: scale(0); opacity: 0; } 50% { transform: scale(1); opacity: 1; } 70% { transform: scale(1); opacity: 1; } 100% { transform: scale(0); opacity: 0; } }
        @keyframes scanLine { 0% { top: 0; opacity: 0; } 5% { opacity: 1; } 95% { opacity: 1; } 100% { top: 100%; opacity: 0; } }
        @keyframes techCirclePulse { 0% { transform: translate(-50%, -50%) scale(0.8); opacity: 0.2; } 50% { transform: translate(-50%, -50%) scale(1); opacity: 0.7; } 100% { transform: translate(-50%, -50%) scale(0.8); opacity: 0.2; } }
        @keyframes particleFloat { 0% { opacity: 0; transform: translateY(20px) rotate(0deg) scale(0.8); } 50% { opacity: 0.8; transform: translateY(-10px) rotate(180deg) scale(1.2); } 100% { opacity: 0; transform: translateY(-40px) rotate(360deg) scale(0.8); } }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes fadeInRight { from { opacity: 0; transform: translateX(20px); } to { opacity: 1; transform: translateX(0); } }
        @keyframes scroll { 0% { opacity: 1; top: 7px; } 50% { opacity: 1; top: 20px; } 100% { opacity: 0; top: 20px; } }
        @keyframes arrow { 0% { opacity: 0; transform: rotate(45deg) translate(-5px, -5px); } 50% { opacity: 1; } 100% { opacity: 0; transform: rotate(45deg) translate(5px, 5px); } }
        @keyframes glowPulse { 0%, 100% { opacity: 0.3; transform: translate(-50%, -50%) scale(1); } 50% { opacity: 0.6; transform: translate(-50%, -50%) scale(1.1); } }
        @keyframes energyWave { 0% { width: 10px; height: 10px; opacity: 1; } 100% { width: 300px; height: 300px; opacity: 0; } }

        /* --- Media Query for Mobile (Nessuna modifica necessaria qui rispetto all'originale per questo problema) --- */
        @media screen and (max-width: 768px) {
            .hero .container {
                flex-direction: column;
                justify-content: center;
                padding-top: 0;
            }

            .hero::after {
                bottom: -24px;
                height: 25px;
            }

            .hero-content, .hero-image {
                width: 100%;
                text-align: center;
                padding: 0;
            }

            .hero-content {
                margin-bottom: 80px; /* Aumentato per dare più spazio all'immagine sotto */
                order: 1;
            }

            .hero-image {
                order: 0;
                /* Riduciamo leggermente l'altezza massima disponibile per l'immagine
                    per assicurare che il contenuto non venga schiacciato troppo */
                max-height: 45vh; /* Valore da aggiustare se necessario */
            }

            h1.hero-title {
                margin-bottom: 16px;
            }

            .hero-subtitle {
                margin-bottom: 24px;
                font-size: 20px;
            }

            .hero-buttons {
                justify-content: center;
                gap: 10px;
            }

            .btn {
                padding: 12px;
                font-size: 18px;

            }

            .dino-avatar-container {
                    /* Adatta la scala se l'immagine sembra troppo grande */
                transform: scale(0.75);
                /* Potrebbe essere necessario aggiustare la posizione verticale */
                /* bottom: -5%; */
                /* Assicurati che non limiti l'altezza del genitore */
                height: auto; /* Permette al contenitore di adattarsi */
                max-height: 100%; /* Limita all'altezza del genitore .hero-image */
            }

            .scroll-indicator {
                display: none;
            }

            .prehistoric-bg {
                bottom: 0;
            }
        }

    </style>

    <!-- Script rimane invariato (assicurarsi che imposti --nav-height correttamente) -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const config = { mouse: { x: 0, y: 0, lastX: 0, lastY: 0 }, autoAnimation: true, particleCount: 15, enableParallax: true };
            const elements = { heroSection: document.querySelector('.hero'), dinoCharacter: document.querySelector('.dino-character'), particles: document.querySelectorAll('.particle'), dataPoints: document.querySelectorAll('.data-point'), scrollIndicator: document.querySelector('.scroll-indicator'), mountains: document.querySelectorAll('.mountain'), trees: document.querySelectorAll('.tree'), heroContainer: document.querySelector('.hero .container') };
            // Assumendo che la variabile navbar sia definita globalmente o in uno script precedente
            // const navbar = document.getElementById('mainNav');

            // Funzione Throttle
            function throttle(func, limit) {
                let inThrottle;
                return function() {
                    const args = arguments;
                    const context = this;
                    if (!inThrottle) {
                        func.apply(context, args);
                        inThrottle = true;
                        setTimeout(() => inThrottle = false, limit);
                    }
                };
            }

            // Gestore Mouse Move (con throttle)
            const handleMouseMove = throttle(function(e) {
                if (!('ontouchstart' in window) || window.innerWidth > 768) {
                    config.mouse.x = e.clientX / window.innerWidth - 0.5;
                    config.mouse.y = e.clientY / window.innerHeight - 0.5;
                    const speedX = Math.abs(config.mouse.x - config.mouse.lastX) * 100;
                    const speedY = Math.abs(config.mouse.y - config.mouse.lastY) * 100;
                    const speed = Math.min(Math.max(speedX + speedY, 0), 1);
                    config.mouse.lastX = config.mouse.x; config.mouse.lastY = config.mouse.y;

                    if (elements.dinoCharacter) { applyTransform(elements.dinoCharacter, `translateY(${-config.mouse.y * 20}px) rotateY(${config.mouse.x * 30}deg) rotateX(${-config.mouse.y * 15}deg) scale(${1 + speed * 0.05})`); }
                    elements.particles.forEach((particle, index) => { const depth = (index % 5) * 0.2 + 0.6; const xFactor = 40 * depth; const yFactor = 30 * depth; applyTransform( particle, `translate(${config.mouse.x * xFactor}px, ${config.mouse.y * yFactor}px) scale(${1 + speed * 0.1 * depth})`); });
                    elements.dataPoints.forEach((point, index) => { const delay = index * 50; const factor = (index % 3) + 1; setTimeout(() => { applyTransform( point, `translate(${config.mouse.x * 20 * factor}px, ${config.mouse.y * 20 * factor}px) rotate(${config.mouse.x * 5}deg)`); }, delay); });
                    if (config.enableParallax) {
                            elements.mountains?.forEach((mountain, index) => { const speed = 0.03 + (index * 0.01); applyTransform(mountain, `translateX(${config.mouse.x * -30 * speed}px)`); });
                            elements.trees?.forEach((tree, index) => { const speed = 0.05 + (index * 0.02); applyTransform(tree, `translateX(${config.mouse.x * -40 * speed}px)`); });
                        }
                    }
            }, 16); // ~60fps

            elements.heroSection.addEventListener('mousemove', handleMouseMove);

            // Gestore Mouse Leave
            elements.heroSection.addEventListener('mouseleave', function() {
                    if (!('ontouchstart' in window) || window.innerWidth > 768) {
                    if (elements.dinoCharacter) { applyTransform(elements.dinoCharacter, 'translateY(0) rotateY(0) rotateX(0)', true); }
                    elements.particles.forEach((particle, index) => { const delay = index * 20; setTimeout(() => { applyTransform(particle, 'translate(0, 0)', true); }, delay); });
                    elements.dataPoints.forEach((point, index) => { const delay = index * 30; setTimeout(() => { applyTransform(point, 'translate(0, 0) rotate(0)', true); }, delay); });
                    if (config.enableParallax) {
                            elements.mountains?.forEach(mountain => { applyTransform(mountain, 'translateX(0)', true); });
                            elements.trees?.forEach(tree => { applyTransform(tree, 'translateX(0)', true); });
                        }
                    }
            });

                // Gestore Click sul Dino
            elements.dinoCharacter?.addEventListener('click', function(e) {
                createEnergyWave(e.clientX, e.clientY);
                const mouth = document.querySelector('.dino-mouth');
                if (mouth) {
                        // Semplice animazione 'talking' aggiungendo/rimuovendo una classe
                        mouth.style.transition = 'height 0.1s ease-in-out';
                        mouth.style.height = '15px';
                        setTimeout(() => { mouth.style.height = '10px'; }, 150);
                        setTimeout(() => { mouth.style.height = '15px'; }, 300);
                        setTimeout(() => { mouth.style.height = '10px'; }, 450);
                }
                applyTransform(elements.dinoCharacter, 'translateY(-10px) scale(1.03)', true); // Ridotto effetto jump
                setTimeout(() => { applyTransform(elements.dinoCharacter, 'translateY(0) scale(1)', true); }, 200); // Ritorno più veloce
            });

            // Gestore Click sullo Scroll Indicator
            elements.scrollIndicator?.addEventListener('click', function() {
                const discoverMoreBtn = document.getElementById('discover-more-btn');
                if (discoverMoreBtn) {
                    const targetId = discoverMoreBtn.getAttribute('href');
                    if (targetId && targetId.startsWith('#')) {
                        const targetElement = document.querySelector(targetId);
                        if (targetElement) {
                            targetElement.scrollIntoView({ behavior: 'smooth' });
                        } else {
                            console.warn('Scroll target not found:', targetId);
                            window.scrollBy({ top: window.innerHeight * 0.8, behavior: 'smooth' }); // Scrolla di meno
                        }
                    } else {
                            window.scrollBy({ top: window.innerHeight * 0.8, behavior: 'smooth' });
                    }
                    } else {
                        window.scrollBy({ top: window.innerHeight * 0.8, behavior: 'smooth' });
                    }
            });

            // Gestore Click sulla Hero Section (per energy wave)
            elements.heroSection.addEventListener('click', function(e) {
                // Crea l'onda solo se il click non è sul dino o sui bottoni
                if (!e.target.closest('.dino-character') && !e.target.closest('.btn')) {
                    createEnergyWave(e.clientX, e.clientY);
                }
            });

            // Funzioni Helper
            function createEnergyWave(x, y) {
                    const rect = elements.heroSection.getBoundingClientRect();
                    const wave = document.createElement('div');
                    wave.className = 'energy-wave';
                    // Assicura che le coordinate siano relative alla sezione hero
                    wave.style.top = (y - rect.top + window.scrollY) + 'px';
                    wave.style.left = (x - rect.left + window.scrollX) + 'px';
                    elements.heroSection.appendChild(wave);
                    setTimeout(() => { wave.remove(); }, 1000); // Rimuove l'onda dopo l'animazione
            }

            function createParticles(count) {
                    const container = document.querySelector('.particles') || document.createElement('div');
                    if (!container.classList.contains('particles')) {
                        container.className = 'particles';
                        // Inserisci prima dell'overlay tecnologico se esiste
                        const techOverlay = elements.heroSection.querySelector('.tech-overlay');
                        if (techOverlay) {
                                elements.heroSection.insertBefore(container, techOverlay);
                        } else {
                                elements.heroSection.appendChild(container);
                        }
                    }

                    for (let i = 0; i < count; i++) {
                        const particle = document.createElement('div');
                        particle.className = 'particle';
                        particle.style.top = `${Math.random() * 100}%`;
                        particle.style.left = `${Math.random() * 100}%`;
                            // Aggiungi ritardi diversi per un effetto meno sincronizzato
                        particle.style.animationDelay = `${Math.random() * 5}s`;
                        container.appendChild(particle);
                    }
                    // Aggiorna l'elenco degli elementi delle particelle
                    elements.particles = elements.heroSection.querySelectorAll('.particle');
            }

            function applyTransform(element, transform, withTransition = false) {
                if (!element) return;
                if (withTransition) {
                    // Applica una transizione definita per il ritorno allo stato base
                    element.style.transition = 'transform 0.3s cubic-bezier(0.25, 0.8, 0.25, 1)'; // Curva ease-out più naturale
                    element.style.transform = transform;
                    // Rimuovi la transizione dopo che è stata applicata,
                    // così non interferisce con le animazioni continue o il mouse move.
                    // Usiamo un piccolo timeout per assicurarci che la transizione venga applicata prima.
                    setTimeout(() => {
                            if(element) element.style.transition = '';
                    }, 450); // Leggermente più lungo della durata della transizione

                } else {
                    // Nessuna transizione per aggiornamenti rapidi (mousemove, animazioni)
                    element.style.transition = 'none';
                    element.style.transform = transform;
                    }
            }


            function startAutoAnimation() {
                    let t = 0;
                    const animate = () => {
                    // Esegui l'animazione solo se l'utente non sta interagendo e non è su touch (o schermo grande)
                    if (!elements.heroSection.matches(':hover') && (!('ontouchstart' in window) || window.innerWidth > 768)) {
                            t += 0.003; // Rallenta leggermente l'animazione
                            const x = Math.sin(t * 0.8) * 0.08; // Movimento orizzontale più ampio e lento
                            const y = Math.cos(t * 1.1) * 0.04; // Movimento verticale più sottile e leggermente più veloce

                            if (elements.dinoCharacter) {
                                applyTransform( elements.dinoCharacter, `translateY(${y * 15}px) rotateY(${x * 15}deg) rotateX(${-y * 8}deg)`); // Ridotto l'effetto di rotazione
                            }
                        // L'animazione delle particelle è già gestita da CSS, non c'è bisogno di aggiornarla qui
                        // a meno che non si voglia un effetto basato su 't'
                        }
                        requestAnimationFrame(animate); // Continua il loop
                    };
                    animate(); // Avvia l'animazione
            }

            // --- Aggiornamento Link Bottone "Scopri di più" ---
            const discoverMoreBtn = document.getElementById('discover-more-btn');
            const mobileBreakpoint = 768;

            function updateDiscoverMoreLink() {
                if (!discoverMoreBtn) return;
                // Cambia il link in base alla larghezza della finestra
                if (window.innerWidth <= mobileBreakpoint) {
                    discoverMoreBtn.href = '#features-mobile'; // Assicurati che esista un ID 'features-mobile'
                } else {
                    discoverMoreBtn.href = '#features-desktop'; // Assicurati che esista un ID 'features-desktop'
                }
            }

            // Inizializzazione
            updateDiscoverMoreLink(); // Imposta il link corretto al caricamento
            if (config.autoAnimation) { startAutoAnimation(); }
            if (elements.particles.length < config.particleCount) { createParticles(config.particleCount - elements.particles.length); }

            // --- Gestore Resize (con debounce/throttle implicito nel timer) ---
            let resizeTimer;
            window.addEventListener('resize', () => {
                    clearTimeout(resizeTimer);
                    resizeTimer = setTimeout(() => {
                        updateDiscoverMoreLink(); // Aggiorna il link al resize
                        // Non è necessario ri-calcolare --nav-height qui se è già gestito altrove
                    }, 150); // Aspetta 150ms dopo l'ultimo evento resize
            }, { passive: true }); // Usa passive listener per performance

        });
    </script>

</section>


    <!-- Desktop Feature -->
<section id="features-desktop">
    <div id="features-container-desktop" class="features-main-section section desktop-only">
        <div class="container">
            <h2 class="section-title">Caratteristiche Principali</h2>

            <!-- Container per tutte le features -->
            <div class="features-list" id="features-carousel-desktop">
                <!-- Feature 1 -->
                <div id="feature-desktop-1" class="feature-parallax-container">
                    <div class="feature-container">
                        <div class="feature-half feature-half-left">
                            <div class="feature-card">
                                <div class="feature-icon-wrapper">
                                    <div class="feature-icon">
                                        <i class="fas fa-wallet"></i>
                                    </div>
                                </div>
                                <h4 class="feature-title">Unica dashboard</h4>
                                <p>Gestisci i tuoi conti per avere una panoramica delle tue spese in un'unica dashboard</p>
                            </div>
                        </div>

                        <div class="center-divider"></div>

                        <div class="feature-half feature-half-right">
                            <div class="video-perspective-container">
                                <!-- Added preload="metadata" -->
                                <video id="parallax-video-desktop-1" class="parallax-video" src="immagini/video1.mp4" playsinline muted loop preload="metadata"></video>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Feature 2 (Invertita) -->
                <div id="feature-desktop-2" class="feature-parallax-container">
                    <div class="feature-container">
                        <div class="feature-half feature-half-left">
                            <div class="video-perspective-container">
                                <!-- Added preload="metadata" -->
                                <video id="parallax-video-desktop-2" class="parallax-video" src="immagini/video1.mp4" playsinline muted loop preload="metadata"></video>
                            </div>
                        </div>

                        <div class="center-divider"></div>

                        <div class="feature-half feature-half-right">
                            <div class="feature-card">
                                <div class="feature-icon-wrapper">
                                    <div class="feature-icon">
                                        <i class="fas fa-users"></i>
                                    </div>
                                </div>
                                <h4 class="feature-title">Conti tra amici</h4>
                                <p>Condividi spese e abbonamenti con gli amici e tieni traccia dei rimborsi senza più conti a mano</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Feature 3 -->
                <div id="feature-desktop-3" class="feature-parallax-container">
                    <div class="feature-container">
                        <div class="feature-half feature-half-left">
                            <div class="feature-card">
                                <div class="feature-icon-wrapper">
                                    <div class="feature-icon">
                                        <i class="fas fa-calendar-alt"></i> <!-- Icona per Insight Intelligenti -->
                                    </div>
                                </div>
                                <h4 class="feature-title">Insight intelligenti</h4>
                                <p>Ricevi promemoria per le tue uscite future e visualizza gli insight sulle tue abitudini di spesa</p>
                            </div>
                        </div>

                        <div class="center-divider"></div>

                        <div class="feature-half feature-half-right">
                            <div class="video-perspective-container">
                                <!-- Added preload="metadata" -->
                                <video id="parallax-video-desktop-3" class="parallax-video" src="immagini/video1.mp4" playsinline muted loop preload="metadata"></video>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <style>
        /* Stili per la versione desktop */
        :root {
            --video-hover-scale: 1.05; /* Variable for video scale */
            --video-base-z: 10px;
            --video-hover-z: 15px;
        }

        /* Nascondi su mobile */
        @media (max-width: 768px) {
            .desktop-only {
                display: none !important;
            }
        }

        #features-container-desktop {
            background-color: white;
            position: relative;
        }

        /* Curva inferiore */
        #features-container-desktop::after {
            content: '';
            position: absolute;
            bottom: -29px; /* Adjust if needed based on curve size */
            left: 0;
            width: 100%;
            height: 30px; /* Adjust if needed */
            background: #ffffff;
            border-radius: 0 0 50% 50% / 0 0 100% 100%;
            z-index: 2;
        }

        #features-container-desktop .features-list {
            display: flex;
            flex-direction: column;
            gap: 6rem; /* Spacing between features */
            width: 100%;
        }

        #features-container-desktop .feature-parallax-container {
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        #features-container-desktop .feature-container {
            display: flex;
            align-items: stretch; /* Make halves equal height */
            justify-content: center;
            width: 90%;
            max-width: 1200px;
            position: relative;
            min-height: 450px; /* Maintain minimum height */
        }

        /* Metà del container */
        #features-container-desktop .feature-half {
            flex: 1;
            display: flex;
            align-items: center;
            padding: 1rem; /* Add slight padding */
            transition: transform 0.5s ease-out, opacity 0.5s ease-out; /* Added transitions for exit anim */
        }

        /* Allinea la card verso il divider */
        #features-container-desktop .feature-half-left {
            justify-content: flex-end;
            padding-right: 0; /* Align closer to divider */
        }

        /* Allinea il video verso il divider */
        #features-container-desktop .feature-half-right {
            justify-content: flex-start;
            padding-left: 0; /* Align closer to divider */
        }

        /* Adjust alignment for inverted layout (Feature 2) */
        #feature-desktop-2 .feature-half-left {
            justify-content: flex-end; /* Video aligned right */
                padding-left: 1rem; /* Reset padding */
                padding-right: 0;
        }
        #feature-desktop-2 .feature-half-right {
            justify-content: flex-start; /* Card aligned left */
            padding-right: 1rem; /* Reset padding */
            padding-left: 0;
        }


        /* Center divider */
        #features-container-desktop .center-divider {
            width: 2px;
            height: 450px;
            background: linear-gradient(to bottom, transparent, var(--secondary), transparent);
            margin: 0 60px;
            flex-shrink: 0;
            transition: opacity 0.5s ease-out;
        }

        #features-container-desktop .video-perspective-container {
            perspective: 1200px;
            transform-style: preserve-3d;
        }

        #features-container-desktop .parallax-video {
            width: 253px;
            height: 450px;
            object-fit: cover;
            border-radius: 24px;
            border: 1px solid var(--secondarylight);
            box-shadow: 0 4px 10px #9495EA66;
            display: block;
            margin: 0 auto;
            transform: translateZ(var(--video-base-z));
            transition: transform 0.3s cubic-bezier(0.25, 0.8, 0.25, 1), box-shadow 0.3s ease;
        }

        #features-container-desktop .video-perspective-container:hover .parallax-video {
            transform: scale(var(--video-hover-scale)) translateZ(var(--video-hover-z));
        }

        #features-container-desktop .feature-card {
            background: white;
            border-radius: 24px; /* Match video radius */
            border: 1px solid var(--secondarylight);
            padding: 32px; /* Adjusted padding */
            box-shadow: 0 4px 10px #9495EA66;
            transition: box-shadow 0.35s ease-out; /* Rimossa transition per border-top-color */
            text-align: center;
            max-width: 320px; /* Slightly wider */
            margin: 0; /* Reset margin if needed */
            position: relative; /* Needed for potential pseudo-elements */
            z-index: 1; /* Ensure card is clickable over other elements */
        }


        /* MODIFICA: Aggiunto margine sotto feature-title */
        #features-container-desktop .feature-title {
            margin-bottom: 8px;
        }

        /* Wrapper per la forma irregolare */
        #features-container-desktop .feature-icon-wrapper {
            position: relative;
            width: 70px;
            height: 70px;
            margin: 0 auto 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Icona con forma inizialmente tonda */
        #features-container-desktop .feature-icon {
            width: 70px;
            height: 70px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--gradient-primary);
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1); /* Ease with overshoot */
            border-radius: 50%; /* Inizia come un cerchio perfetto */


            /* Blob shapes preimpostate ma non applicate inizialmente */
            --blob1: 60% 40% 65% 35% / 35% 65% 35% 65%; /* Shape per Feature 1 */
            --blob2: 40% 60% 30% 70% / 60% 30% 70% 40%; /* Shape per Feature 2 */
            --blob3: 70% 30% 60% 40% / 30% 70% 30% 70%; /* Shape per Feature 3 (presa da HowItWorks step 4) */
        }

        #features-container-desktop .feature-icon i {
            font-size: 1.8rem;
            transition: transform 0.3s ease;
            color: var(--text);
        }

            /* Icon hover state */
        #features-container-desktop .feature-card:hover .feature-icon {
            background: linear-gradient(135deg, #84CD9D 60%, #9495EA 100%);
            transform: scale(1.1); /* Increased scale slightly */
            border-radius: var(--blob-shape); /* Apply the pre-stored blob shape */
        }

            /* Optional: Rotate the icon itself slightly on hover */
            #features-container-desktop .feature-card:hover .feature-icon i {
                transform: rotate(5deg); /* Rotate and slightly shrink icon */
            }

    </style>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Assegna a ciascuna icona una forma di blob predefinita (ma non applicarla subito)
            const featureIcons = document.querySelectorAll('#features-container-desktop .feature-icon');
                // --- NOTA: I VALORI EFFETTIVI sono definiti nel CSS ora ---
            const blobShapes = [ 'var(--blob1)', 'var(--blob2)', 'var(--blob3)' ];

            featureIcons.forEach((icon, index) => {
                // Assicura che ci sia una forma definita per questo indice, altrimenti usa l'ultima
                const blobShapeVar = blobShapes[index < blobShapes.length ? index : blobShapes.length - 1];
                icon.style.setProperty('--blob-shape', blobShapeVar);
            });

            // Inizializzazione per desktop
            initializeDesktopFeature('feature-desktop-1', 'parallax-video-desktop-1');
            initializeDesktopFeature('feature-desktop-2', 'parallax-video-desktop-2');
            initializeDesktopFeature('feature-desktop-3', 'parallax-video-desktop-3');

            function initializeDesktopFeature(featureId, videoId) {
                const featureSection = document.getElementById(featureId);
                if (!featureSection) return;

                const parallaxVideo = document.getElementById(videoId);
                const centerDivider = featureSection.querySelector('.center-divider');
                const leftHalf = featureSection.querySelector('.feature-half-left');
                const rightHalf = featureSection.querySelector('.feature-half-right');
                const videoContainer = featureSection.querySelector('.video-perspective-container'); // Define videoContainer here

                // --- Parameters for Mouse Effect (Adjust as needed) ---
                const MOUSE_ROTATION_FACTOR = 10; // Slightly reduced rotation for subtlety with scale
                const MOUSE_TRANSLATE_Z = 45;     // Increased Z translation for more pop
                const VIDEO_HOVER_SCALE = 1.05;   // Get scale from CSS variable or define here

                if (parallaxVideo) {
                    parallaxVideo.loop = true;
                    parallaxVideo.muted = true; // Ensure it's muted
                    parallaxVideo.playsInline = true; // Good practice
                }

                const mapRange = (value, in_min, in_max, out_min, out_max) => {
                        const clampedValue = Math.max(in_min, Math.min(value, in_max));
                        return (clampedValue - in_min) * (out_max - out_min) / (in_max - in_min) + out_min;
                };

                // Imposta le posizioni iniziali
                if (leftHalf) { leftHalf.style.transform = 'translateX(0)'; leftHalf.style.opacity = '1'; }
                if (rightHalf) { rightHalf.style.transform = 'translateX(0)'; rightHalf.style.opacity = '1'; }
                if (centerDivider) { centerDivider.style.opacity = '1'; }

                // --- Parallax 3D effect on mousemove ---
                if (videoContainer && parallaxVideo) {
                    videoContainer.addEventListener('mousemove', (e) => {
                        const rect = videoContainer.getBoundingClientRect();
                        const x = (e.clientX - rect.left) / rect.width; // 0 to 1
                        const y = (e.clientY - rect.top) / rect.height; // 0 to 1

                        const rotateX = mapRange(y, 0, 1, MOUSE_ROTATION_FACTOR, -MOUSE_ROTATION_FACTOR);
                        const rotateY = mapRange(x, 0, 1, -MOUSE_ROTATION_FACTOR, MOUSE_ROTATION_FACTOR);

                        // Apply rotation, dynamic Z, AND the hover scale via inline style
                        // This overrides the CSS :hover transform temporarily while moving
                        parallaxVideo.style.transform = `scale(${VIDEO_HOVER_SCALE}) rotateX(${rotateX}deg) rotateY(${rotateY}deg) translateZ(${MOUSE_TRANSLATE_Z}px)`;
                    });

                    videoContainer.addEventListener('mouseleave', () => {
                        // *** KEY CHANGE ***
                        // Remove the inline style entirely. This allows the CSS :hover state
                        // (which includes the scale and base hover Z) or the base CSS state
                        // (which includes the base Z) to take effect smoothly.
                        parallaxVideo.style.transform = '';
                    });
                }

                // Scroll animation logic (remains largely the same)
                let isVisible = false;
                const updateAnimation = () => {
                    if (window.innerWidth <= 768) return; // Only run on desktop

                    const rect = featureSection.getBoundingClientRect();
                    const windowHeight = window.innerHeight;
                    const navbarHeight = 70; // Or get dynamically if possible

                    const isInView = rect.top < windowHeight && rect.bottom > navbarHeight; // Ensure bottom is below navbar too
                    const hasReachedNavbar = rect.top <= navbarHeight;

                    const exitPercentage = hasReachedNavbar
                        ? Math.min(1, (navbarHeight - rect.top) / (rect.height / 1.5)) // Make exit slightly faster
                        : 0;

                        // Play/Pause logic refined
                        if (parallaxVideo) {
                        const shouldBePlaying = isInView && !hasReachedNavbar; // Play only when fully visible before exit starts

                        if (shouldBePlaying && !isVisible) {
                                parallaxVideo.play().catch(e => { /* console.error("Video play failed:", e) */ });
                                isVisible = true;
                            } else if (!shouldBePlaying && isVisible) {
                                parallaxVideo.pause();
                                isVisible = false;
                            }
                        }

                        // Apply exit animation styles
                        if (hasReachedNavbar) {
                            const opacity = Math.max(0, 1 - exitPercentage * 1.5); // Faster fade out
                            const translateAmount = mapRange(exitPercentage, 0, 1, 0, 150); // Slide out

                            if (leftHalf) {
                                leftHalf.style.opacity = opacity;
                                const hasVideo = leftHalf.querySelector('.video-perspective-container');
                                leftHalf.style.transform = `translateX(${hasVideo ? '-' : ''}${translateAmount}px)`;
                            }
                            if (rightHalf) {
                                rightHalf.style.opacity = opacity;
                                const hasVideo = rightHalf.querySelector('.video-perspective-container');
                                rightHalf.style.transform = `translateX(${hasVideo ? '' : '-'}${translateAmount}px)`;
                            }
                            if (centerDivider) {
                                centerDivider.style.opacity = opacity;
                            }
                        } else {
                            // Reset styles if element scrolls back into view fully
                            if (leftHalf) { leftHalf.style.transform = 'translateX(0)'; leftHalf.style.opacity = '1'; }
                            if (rightHalf) { rightHalf.style.transform = 'translateX(0)'; rightHalf.style.opacity = '1'; }
                            if (centerDivider) { centerDivider.style.opacity = '1'; }
                        }
                    };

                window.addEventListener('scroll', updateAnimation, { passive: true });
                updateAnimation(); // Initial check
            }
        });
    </script>

</section>


    <!-- Mobile Feature -->
<section id="features-mobile" class="features-main-section section mobile-only">
    <div class="container">
        <h2 class="section-title">Caratteristiche Principali</h2>

        <!-- Indicatori di pagina (SPOSTATI QUI, UN SOLO SET) -->
        <div class="feature-indicators">
            <span class="feature-dot active" data-index="0"></span>
            <span class="feature-dot" data-index="1"></span>
            <span class="feature-dot" data-index="2"></span>
        </div>

        <!-- NUOVO: Wrapper per Carosello, Frecce -->
        <div class="features-carousel-wrapper">

            <!-- Container per tutte le features (le slide) -->
            <div class="features-list" id="features-carousel-mobile">
                <!-- Feature 1 -->
                <div id="feature-mobile-1" class="feature-container-slide">
                    <div class="feature-container">
                        <!-- Indicatori RIMOSSI da qui -->
                        <div class="feature-content">
                            <!-- Titolo e descrizione -->
                            <h4 class="feature-title">Unica dashboard</h4>
                            <p class="feature-description">Gestisci i tuoi conti per avere una panoramica delle tue spese in un'unica dashboard</p>
                        </div>
                        <div class="feature-media">
                            <video id="video-mobile-1" class="feature-video" src="immagini/video1.mp4" playsinline muted loop></video>
                        </div>
                    </div>
                    <!-- Frecce RIMOSSE da qui -->
                </div>

                <!-- Feature 2 -->
                <div id="feature-mobile-2" class="feature-container-slide">
                    <div class="feature-container">
                        <!-- Indicatori RIMOSSI da qui -->
                        <div class="feature-content">
                            <!-- Titolo e descrizione -->
                            <h4 class="feature-title">Conti tra amici</h4>
                            <p class="feature-description">Condividi spese e abbonamenti con gli amici e tieni traccia dei rimborsi senza più conti a mano</p>
                        </div>
                        <div class="feature-media">
                            <video id="video-mobile-2" class="feature-video" src="immagini/video1.mp4" playsinline muted loop></video>
                        </div>
                    </div>
                    <!-- Frecce RIMOSSE da qui -->
                </div>

                <!-- Feature 3 -->
                <div id="feature-mobile-3" class="feature-container-slide">
                    <div class="feature-container">
                        <!-- Indicatori RIMOSSI da qui -->
                        <div class="feature-content">
                            <!-- Titolo e descrizione -->
                            <h4 class="feature-title">Insight intelligenti</h4>
                            <p class="feature-description">Ricevi promemoria per le tue uscite future e visualizza gli insight sulle tue abitudini di spesa</p>
                        </div>
                        <div class="feature-media">
                            <video id="video-mobile-3" class="feature-video" src="immagini/video1.mp4" playsinline muted loop></video> <!-- Assicurati sia il video giusto -->
                        </div>
                    </div>
                    <!-- Frecce RIMOSSE da qui -->
                </div>
            </div> <!-- Fine features-list -->

            <!-- Frecce di navigazione laterali (UN SOLO SET) -->
            <button class="nav-arrow prev-arrow"><i class="fas fa-chevron-left"></i></button>
            <button class="nav-arrow next-arrow"><i class="fas fa-chevron-right"></i></button>

        </div> <!-- Fine features-carousel-wrapper -->
    </div>

    <style>


        /* Nascondi su desktop (come originale) */
        .mobile-only {
            display: none !important;
        }

        @media (max-width: 768px) {
            .mobile-only {
                display: block !important;
            }
        }

        #features-mobile {
            background-color: white;
            position: relative;
        }

        /* Curva inferiore (come originale) */
        #features-mobile::after {
            content: '';
            position: absolute;
            bottom: -24px; /* Potrebbe necessitare aggiustamento se l'altezza cambia */
            left: 0;
            width: 100%;
            height: 25px;
            background: #ffffff;
            border-radius: 0 0 50% 50% / 0 0 100% 100%;
            z-index: 2;
        }

        /* MODIFICATO: Indicatori (dots) posizionati SOTTO il titolo principale della sezione */
        #features-mobile > .container > .feature-indicators { /* More specific selector */
            display: flex;
            gap: 10px;
            justify-content: center;
            width: 100%;
            margin-bottom: 16px; /* Spazio sotto i dots, sopra il carosello */
        }

         /* Stile dot */
        #features-mobile > .container > .feature-indicators .feature-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #D8DBDA;
            cursor: pointer;
            transition: all 0.3s;
        }

        #features-mobile > .container > .feature-indicators .feature-dot.active {
            background: var(--secondary);
            transform: scale(1.2);
        }


        /* Wrapper del carosello */
        .features-carousel-wrapper {
            position: relative; /* Necessario per posizionare frecce */
        }

        /* Contenitore delle slide */
        #features-mobile .features-list {
            display: block;
            overflow: hidden;
            width: 100%;
            position: relative;
            height: 550px; /* Altezza leggermente ridotta per fare spazio ai dots sopra */
        }

        /* Singola slide */
        #features-mobile .feature-container-slide {
            width: 100%;
            min-width: 100%;
            transition: transform 0.3s ease-in-out;
            margin: 0;
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            will-change: transform;
        }

        /* Stili interni della card */
        #features-mobile .feature-container {
            position: relative;
            width: 90%;
            max-width: 350px;
            height: auto;
            margin: 15px auto 0 auto;
            background: white;
            border-radius: 24px;
            box-shadow: 0 4px 10px #9495EA66;
            border: 1px solid var(--secondarylight);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 24px;
        }

        #features-mobile .feature-content {
            order: 1;
            width: 100%;
            text-align: center;
        }

        #features-mobile .feature-title {
            padding-bottom: 8px;
        }

        #features-mobile .feature-media {
            order: 2;
            width: 100%;
            display: flex;
            justify-content: center;
            padding-top: 24px;
        }

        #features-mobile .feature-video {
            width: 170px;
            height: auto;
            object-fit: cover;
            border-radius: 16px;
        }

        /* Navigazione (frecce) */
        .features-carousel-wrapper .nav-arrow {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background:  #ffffff;
            border: 1px solid var(--secondarylight);
            color: var(--secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 16px;
            position: absolute;
            top: 45%; /* Adjusted if carousel height changed */
            transform: translateY(-50%);
            z-index: 10;
            box-shadow: 0 4px 10px #9495EA66;
        }

        .features-carousel-wrapper .prev-arrow {
            left: 10px;
        }

        .features-carousel-wrapper .next-arrow {
            right: 10px;
        }

        .features-carousel-wrapper .nav-arrow:active {
            background: var(--gradient-secondary);
            color: white;
            transform: translateY(-50%) scale(0.95);
        }
    </style>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const featuresMobileSection = document.getElementById('features-mobile');
            // Robust check for mobile visibility
            if (!featuresMobileSection || (window.innerWidth > 768 && window.getComputedStyle(featuresMobileSection).display === 'none')) {
                 if (!featuresMobileSection && window.innerWidth > 768) return;
                 if (featuresMobileSection && window.getComputedStyle(featuresMobileSection).display === 'none' && window.innerWidth > 768) return;
                 if (!featuresMobileSection) return; // Final check if section itself doesn't exist
            }

            let currentFeatureIndex = 0;
            const featuresCarousel = document.getElementById('features-carousel-mobile');
            const featureElements = featuresCarousel?.querySelectorAll('.feature-container-slide');
            const totalFeatures = featureElements?.length || 0;

            if (!featuresCarousel || totalFeatures === 0) {
                console.error("Features carousel or slides not found.");
                return;
            }

            // MODIFICATO: Seleziona il wrapper comune per frecce
            const carouselWrapper = featuresCarousel.closest('.features-carousel-wrapper');
             if (!carouselWrapper) {
                console.error("Wrapper .features-carousel-wrapper non trovato.");
                return;
             }

            // MODIFICATO: Seleziona i dots globali (fuori dal wrapper del carosello, dentro .container)
            const sectionContainer = featuresMobileSection.querySelector('.container');
            const dotsContainer = sectionContainer?.querySelector('.feature-indicators');
            const dots = dotsContainer?.querySelectorAll('.feature-dot');
            const prevBtn = carouselWrapper.querySelector('.prev-arrow');
            const nextBtn = carouselWrapper.querySelector('.next-arrow');

            // Verifica elementi UI essenziali
            if (!dots || dots.length !== totalFeatures || !prevBtn || !nextBtn) {
                console.error("Elementi UI (dots, frecce) non trovati o numero incorretto.", {
                    dots: dots ? dots.length : 'ND',
                    totalFeatures,
                    prevBtn: !!prevBtn,
                    nextBtn: !!nextBtn
                });
                return;
            }

            let isAnimating = false;

            function setupMobileCarousel() {
                updateActiveDot(0); // Aggiorna il set globale di dots
                featureElements.forEach((feature, index) => {
                    const video = feature.querySelector('.feature-video');
                    if (index === 0) {
                        feature.style.transform = 'translateX(0)';
                        feature.style.visibility = 'visible';
                        feature.style.opacity = '1';
                        if (video) video.play().catch(e => console.warn("Video play initial failed:", e));
                    } else {
                        feature.style.transform = 'translateX(100%)';
                        feature.style.visibility = 'visible';
                        feature.style.opacity = '1';
                        if (video) video.pause();
                    }
                    feature.style.transition = 'transform 0.3s ease-in-out, opacity 0.3s ease-in-out';
                });
            }

            // MODIFICATO: Aggiorna il dot attivo sul set globale
            function updateActiveDot(index) {
                dots.forEach((dot, i) => {
                    if (i === index) {
                        dot.classList.add('active');
                    } else {
                        dot.classList.remove('active');
                    }
                });
            }

            function goToFeature(index) {
                if (isAnimating) return;
                isAnimating = true;

                const previousIndex = currentFeatureIndex;
                currentFeatureIndex = (index + totalFeatures) % totalFeatures;

                let direction = 1; // Default to forward
                if (index < previousIndex) { // Moving backwards
                    if (previousIndex === 0 && currentFeatureIndex === totalFeatures - 1) { // Loop from first to last
                        direction = -1;
                    } else {
                        direction = -1;
                    }
                } else if (index > previousIndex) { // Moving forwards
                     if (previousIndex === totalFeatures - 1 && currentFeatureIndex === 0) { // Loop from last to first
                        direction = 1;
                    } else {
                        direction = 1;
                    }
                }
                // If index === previousIndex (e.g., clicked active dot), direction might need specific handling or just do nothing.
                // Current logic will likely keep direction = 1 if index === previousIndex after modulo.

                document.querySelectorAll('#features-mobile .feature-video').forEach(video => {
                    video.pause();
                });

                featureElements.forEach((feature, idx) => {
                    const video = feature.querySelector('.feature-video');
                    if (idx === previousIndex) {
                        feature.style.transition = 'transform 0.3s ease-in-out';
                        feature.style.transform = direction === 1 ? 'translateX(-100%)' : 'translateX(100%)';
                    } else if (idx === currentFeatureIndex) {
                        feature.style.transition = 'none';
                        feature.style.transform = direction === 1 ? 'translateX(100%)' : 'translateX(-100%)';
                        feature.offsetHeight; // Force reflow
                        feature.style.transition = 'transform 0.3s ease-in-out';
                        feature.style.transform = 'translateX(0%)';
                        if (video) {
                            video.play().catch(e => console.warn("Video play failed:", e));
                        }
                    } else {
                        // Ensure other slides are positioned correctly off-screen
                        feature.style.transition = 'none';
                        feature.style.transform = 'translateX(100%)'; // Or -100% depending on a preferred default
                    }
                });

                updateActiveDot(currentFeatureIndex);

                setTimeout(() => {
                    isAnimating = false;
                    featureElements.forEach(feature => {
                        if (feature.style.transition === 'none') {
                           feature.style.transition = '';
                        }
                    });
                }, 400);
            }

            prevBtn?.addEventListener('click', () => {
                goToFeature(currentFeatureIndex - 1);
            });

            nextBtn?.addEventListener('click', () => {
                goToFeature(currentFeatureIndex + 1);
            });

            // MODIFICATO: Event listener per i dot indicatori globali
            if (dots && dots.length) {
                dots.forEach((dot) => {
                    dot.addEventListener('click', () => {
                        const index = parseInt(dot.getAttribute('data-index'));
                        if (index !== currentFeatureIndex && !isAnimating) {
                            goToFeature(index);
                        }
                    });
                });
            }

            setupMobileCarousel();

            let resizeTimeout;
            window.addEventListener('resize', () => {
                clearTimeout(resizeTimeout);
                resizeTimeout = setTimeout(() => {
                    const isMobileNow = window.getComputedStyle(featuresMobileSection).display !== 'none';
                    if (isMobileNow) {
                        setupMobileCarousel();
                    }
                }, 250);
            }, { passive: true });

            if (featuresCarousel) {
                let touchStartX = 0;
                let touchEndX = 0;

                featuresCarousel.addEventListener('touchstart', (e) => {
                    if (isAnimating) return;
                    touchStartX = e.changedTouches[0].screenX;
                }, { passive: true });

                featuresCarousel.addEventListener('touchend', (e) => {
                    if (isAnimating || touchStartX === 0) return;
                    touchEndX = e.changedTouches[0].screenX;
                    handleSwipe();
                    touchStartX = 0;
                    touchEndX = 0;
                }, { passive: true });

                function handleSwipe() {
                    const swipeThreshold = 50;
                    if (touchEndX < touchStartX - swipeThreshold) {
                        goToFeature(currentFeatureIndex + 1);
                    } else if (touchEndX > touchStartX + swipeThreshold) {
                        goToFeature(currentFeatureIndex - 1);
                    }
                }
            }
        });
    </script>

</section>

    <!-- Avatar Evolution Section -->
<section id="avatar-evolution" class="avatar-evolution section">

    <div class="container">
    <h2 class="section-title">Avatar</h2>
    <p class="section-subtitles">Scegli l'avatar che ti rappresenta e fallo evolvere migliorando le tue abitudini di spesa!</p>
    
    <div class="avatar-selection-container">
        <!-- Card 1 -->
        <div class="avatar-card">
            <div class="card-inner">
                <div class="card-front">
                    <div class="avatar-container">
                        <div class="avatar-shape avatar-shape-1">
                            <div class="avatar-wrapper">
                                <img src="immagini/liv 1.png" alt="Avatar livello 1" class="avatar-image">
                            </div>
                        </div>
                    </div>
                    <div class="card-info">
                        <h4>Francesco</h4>
                        <p>Look da hipster squattrinato, ma con stile. Vive tra arte e il dramma del conto in rosso.</p>
                        <div class="level-badge">Principiante</div>
                    </div>
                </div>
                <div class="card-back">
                    <img src="immagini/liv 1 full.png" alt="Avatar livello 1" class="avatar-fullscreen">
                </div>
            </div>
        </div>
        
        <!-- Card 2 -->
        <div class="avatar-card">
            <div class="card-inner">
                <div class="card-front">
                    <div class="avatar-container">
                        <div class="avatar-shape avatar-shape-2">
                            <div class="avatar-wrapper">
                                <img src="immagini/liv 2.png" alt="Avatar livello 2" class="avatar-image">
                            </div>
                        </div>
                    </div>
                    <div class="card-info">
                        <h4>Fabiola</h4>
                        <p>Mamma di famiglia, esperta di risparmio e di "dove sono le chiavi?!" </p>
                        <div class="level-badge">Intermedio</div>
                    </div>
                </div>
                <div class="card-back">
                    <img src="immagini/liv 2 full.png" alt="Avatar livello 2" class="avatar-fullscreen">
                </div>
            </div>
        </div>
        
        <!-- Card 3 -->
        <div class="avatar-card">
            <div class="card-inner">
                <div class="card-front">
                    <div class="avatar-container">
                        <div class="avatar-shape avatar-shape-3">
                            <div class="avatar-wrapper">
                                <img src="immagini/liv 3.png" alt="Avatar livello 3" class="avatar-image">
                            </div>
                        </div>
                    </div>
                    <div class="card-info">
                        <h4>Andrea</h4>
                        <p>Eleganza casual, ma con Excel aperto. Divide l’aperitivo al centesimo, ma con classe.</p>
                        <div class="level-badge">Avanzato</div>
                    </div>
                </div>
                <div class="card-back">
                    <img src="immagini/liv 3 full.png" alt="Avatar livello 3" class="avatar-fullscreen">
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    
    .avatar-evolution {
        background: #E6F2F5;
        position: relative;
    }

    /* Curva inferiore */
    .avatar-evolution::after {
        content: '';
        position: absolute;
        bottom: -29px;
        left: 0;
        width: 100%;
        height: 30px;
        background: #E6F2F5;
        border-radius: 0 0 50% 50% / 0 0 100% 100%;
        z-index: 2;
    }
    
    .avatar-selection-container {
        display: flex;
        justify-content: center;
        gap: 30px;
        flex-wrap: wrap;
        max-width: 1200px;
        margin: 0 auto;
    }
    
    /* Card styles */
    .avatar-card {
        width: 280px;
        height: 385px;
        perspective: 1000px;
        margin-bottom: 20px;
        transition: all 0.3s ease-out;
    }
    
    .card-inner {
        position: relative;
        width: 100%;
        height: 100%;
        transition: transform 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        transform-style: preserve-3d;
        box-shadow: 0 4px 10px #9495EA66;
        border-radius: 24px;
        border: 1px solid var(--secondarylight);
        will-change: transform;
    }
    
    .avatar-card:hover .card-inner {
        transform: rotateY(180deg) scale(1.05);
        box-shadow: 0 4px 10px #9495EA66;
        }
    
    .card-front, .card-back {
        position: absolute;
        width: 100%;
        height: 100%;
        backface-visibility: hidden;
        border-radius: 24px;
        overflow: hidden;
        transform-style: preserve-3d;
    }
    
    .card-front {
        background-color: white;
        display: flex;
        flex-direction: column;
    }
    
    .card-back {
        background-color: white;
        transform: rotateY(180deg);
        display: flex;
        justify-content: center;
        align-items: center;
    }

    /* Avatar container background */
    .avatar-container {
        width: 100%;
        height: 180px;
        position: relative;
        overflow: hidden; /* This is important for the border-radius to clip the background */
        background: var(--gradient-primary);
        display: flex;
        align-items: center;
        justify-content: center;
        /* ADDED: Curve for the bottom edge */
        border-bottom-left-radius: 50% 30px; 
        border-bottom-right-radius: 50% 30px;
    }

    /* Irregular shape containers for avatars */
    .avatar-shape {
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
        width: 140px;
        height: 140px;
        transition: transform 0.3s ease;
    }

    /* Avatar wrapper - this will have the border and clip-path */
    .avatar-wrapper {
        width: 100%;
        height: 100%;
        position: relative;
        overflow: hidden;
        border: 5px solid white;
    }

    /* Style for shape 1 - blob shape */
    .avatar-shape-1 .avatar-wrapper {
        border-radius: 60% 40% 65% 35% / 35% 65% 35% 65%;
    }

    /* Style for shape 2 - different blob shape */
    .avatar-shape-2 .avatar-wrapper {
        border-radius: 40% 60% 30% 70% / 60% 30% 70% 40%;
    }

    /* Style for shape 3 - another blob shape */
    .avatar-shape-3 .avatar-wrapper {
        border-radius: 70% 30% 60% 40% / 30% 70% 30% 70%;
    }

    /* Avatar image contained inside the shape */
    .avatar-image {
        width: 100%;
        height: 100%;
        object-fit: cover;
        display: block;
    }
    
    /* Fullscreen image on the back */
    .avatar-fullscreen {
        width: 100%;  /* Changed from 90% */
        height: 100%; /* Changed from 90% */
        object-fit: cover; /* Changed from contain */
        transform: translateZ(0px); /* Keep for 3D context if needed */
        /* Ensure it respects the parent's border-radius */
        border-radius: 16px;
    }

    /* Card info section */
    .card-info {
        padding: 24px;
        padding-top: 12px;
        text-align: center;
        background: white;
        flex-grow: 1;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
    }

    .level-badge {
        display: inline-block;
        padding: 0.35rem 1rem;
        border-radius: 50px;
        font-size: 0.8rem;
        font-weight: 600;
        text-transform: uppercase;
    }

    /* Badge colors */
    .avatar-card:nth-child(1) .level-badge {
        background-color: #E8F5E9;
        color: #2a9d64;
    }

    .avatar-card:nth-child(2) .level-badge {
        background-color: #E3F2FD;
        color: #2270b8;
    }

    .avatar-card:nth-child(3) .level-badge {
        background-color: #EDE7F6;
        color: #6651b8;
    }
    
    /* Effetto 3D per gli elementi nelle card */
    .card-front > *, .card-back > * {
        transform: translateZ(0px);
    }
    
    /* Media query for responsive design */
    @media (max-width: 768px) {

        .avatar-selection-container {
            gap: 20px;
        }

            /* Curva inferiore */
        .avatar-evolution::after {
            bottom: -24px;
            height: 25px;
        }
        
        /* Per dispositivi mobili: disattiva l'effetto hover */
        .avatar-card:hover .card-inner {
            transform: none;
            box-shadow: 0 4px 10px #9495EA66;
        }
        
        /* La card si gira solo quando ha la classe flipped */
        .avatar-card .card-inner.flipped {
            transform: rotateY(180deg);
            box-shadow: 0 4px 10px #9495EA66;
        }

    }

</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const cards = document.querySelectorAll('.avatar-card');
    let isMobile = window.innerWidth < 768;
    let activeCard = null;
    
    // Funzione per aggiornare lo stato mobile/desktop
    function updateDeviceState() {
        isMobile = window.innerWidth < 768;
        
        // Resetta tutte le card quando cambia lo stato del dispositivo
        cards.forEach(card => {
            const cardInner = card.querySelector('.card-inner');
            cardInner.classList.remove('flipped');
            cardInner.style.transform = '';
        });
        
        activeCard = null;
    }
    
    // Monitora i cambiamenti nelle dimensioni della finestra
    window.addEventListener('resize', updateDeviceState);
    
    cards.forEach(card => {
        const cardInner = card.querySelector('.card-inner');
        
        // Gestione degli eventi di click/touch per dispositivi mobili
        card.addEventListener('click', function(e) {
            if (isMobile) {
                // Se c'è una card già attiva e non è questa, resettala
                if (activeCard && activeCard !== cardInner) {
                    activeCard.classList.remove('flipped');
                    activeCard.style.transform = '';
                }
                
                // Attiva/disattiva questa card
                cardInner.classList.toggle('flipped');
                if (cardInner.classList.contains('flipped')) {
                    cardInner.style.transform = 'rotateY(180deg)';
                    activeCard = cardInner;
                } else {
                    cardInner.style.transform = '';
                    activeCard = null;
                }
                
                // Seleziona questa card
                cards.forEach(c => c.classList.remove('selected'));
                card.classList.add('selected');
                
                // Logica per salvare la selezione dell'avatar
                const avatarIndex = Array.from(cards).indexOf(card) + 1;
                console.log(`Avatar di livello ${avatarIndex} selezionato!`);
            }
        });
        
        // Effetto 3D solo per desktop
        card.addEventListener('mousemove', function(e) {
            if (!isMobile) {
                // Calcola la posizione del cursore relativa alla card
                const rect = card.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                
                // Punto centrale della card
                const centerX = rect.width / 2;
                const centerY = rect.height / 2;
                
                // Calcola lo spostamento dal centro (da -1 a 1)
                const deltaX = (x - centerX) / centerX;
                const deltaY = (y - centerY) / centerY;
                
                // Converti in gradi di rotazione (massimo ±15 gradi)
                const xRotation = deltaY * 15; // Movimento verticale: positivo quando il mouse è in basso
                const yRotation = deltaX * 15; // Movimento orizzontale: positivo quando il mouse è a destra
                
                // Applica solo l'effetto 3D, lasciando che l'hover CSS gestisca il flip
                if (cardInner.classList.contains('flipped')) {
                    cardInner.style.transform = `rotateY(180deg) scale(1.05) rotateX(${xRotation}deg) rotateY(${yRotation}deg)`;
                } else {
                    cardInner.style.transform = `rotateX(${xRotation}deg) rotateY(${yRotation}deg)`;
                }
            }
        });
        
        // Gestisci il flip della card su desktop tramite hover
        card.addEventListener('mouseenter', function() {
            if (!isMobile) {
                // Aggiungi la classe per tenere traccia dello stato flippato
                setTimeout(() => {
                    cardInner.classList.add('flipped');
                }, 50);
            }
        });
        
        // Resetta la trasformazione quando il cursore esce dalla card (solo desktop)
        card.addEventListener('mouseleave', function() {
            if (!isMobile) {
                cardInner.classList.remove('flipped');
                cardInner.style.transform = '';
            }
        });
    });
    
    // Imposta lo stato iniziale
    updateDeviceState();
});
</script>

<!-- Hub SUB-Section -->
<div class="container">
    <h2 class="section-title">Hub</h2>
    <p class="section-subtitles">Incontra i tuoi amici per ricevere in automatico promemoria utili e condividere i progressi.</p>

    <div class="card-container">
        <div class="card">
            <div class="card-bg" style="background-image: url('immagini/sfondo hub.png');"></div>
            <div class="image-container">
                <!-- Immagine sinistra con nuvoletta -->
                <div id="wrapper-left" class="image-wrapper">
                    <div class="bubble-wrapper">
                        <img id="speech-bubble-left" class="speech-bubble" src="immagini/nuvola1.png" alt="Dialogo">
                    </div>
                    <img id="img-left" class="image" src="immagini/liv 1 vuoto.png" alt="Liv 1 Vuoto">
                    <span class="image-label">Giacomo P. - Liv 1</span>
                </div>

                <!-- Immagine centrale (avatar utente) -->
                <div id="wrapper-center" class="image-wrapper">
                    <img id="img-center" class="image" src="immagini/liv 2 vuoto.png" alt="Liv 2 Vuoto">
                    <span class="image-label user-avatar"><i class="user-icon">👤</i>- Liv 2 </span>
                </div>

                <!-- Immagine destra con nuvoletta -->
                <div id="wrapper-right" class="image-wrapper">
                    <div class="bubble-wrapper">
                        <img id="speech-bubble-right" class="speech-bubble" src="immagini/nuvola3.png" alt="Dialogo">
                    </div>
                    <img id="img-right" class="image" src="immagini/liv 3 vuoto.png" alt="Liv 3 Vuoto">
                    <span class="image-label">Antonio S. - Liv 3</span>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    /* Aggiungere spazio sopra e sotto il container per evitare tagli con zoom */
    .container {
        position: relative;
    }

    :root {
        /* Define your --secondary color if not already globally defined */
        /* --secondary: #9495EA; */ /* Example, ensure this is available */
        /* --gradient-primary: linear-gradient(135deg, #84CD9D 0%, #9495EA 100%); */ /* Ensure this is available */


        --speech-bubble-space: -30px;
        --card-width: 800px;
        --card-height: 500px;
        --image-width: 180px;
        --image-height: 250px;
        --bubble-width: 300px;
    }

    /* Limitare overflow solo alla sezione Hub, ma permettere overflow verticale */
    .card-container {
        overflow-x: hidden;
        overflow-y: visible;
        width: 100%;
    }

    .game-hub {
        background: #E6F2F5;
        position: relative;
    }

    /* Curva inferiore */
    .game-hub::after {
        content: '';
        position: absolute;
        bottom: -30px;
        left: 0;
        width: 100%;
        height: 30px;
        background: #E6F2F5;
        border-radius: 0 0 50% 50% / 0 0 100% 100%;
        z-index: 2;
    }

    .card-container {
        display: flex;
        justify-content: center;
        align-items: center;
        margin: auto auto auto auto;
        max-width: 100%;
        perspective: 1500px;
        overflow: visible; /* Cambiato da hidden a visible */
    }

    .card {
        transition: all 0.3s ease;
        border-radius: var(--border-radius-big);
        background-color: white;
        width: var(--card-width);
        height: var(--card-height);
        overflow: visible !important;
        position: relative;
        margin: 0 auto;
        max-width: 100%;
        aspect-ratio: 16/10;
        perspective: none;
        transform-style: preserve-3d;
        background-size: cover;
        background-position: center;
        box-shadow: 0 0px 10px #9495EA66; /* Base purple shadow */
    }

    /* Aggiungiamo un div per lo sfondo con effetto zoom */
    .card-bg {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-size: cover;
        background-position: center;
        transition: transform 0.3s ease;
        border-radius: var(--border-radius-big);
        border: 1px solid var(--secondarylight);
        overflow: hidden;
        z-index: 0;
        box-shadow: 0 4px 10px #9495EA66; /* Base purple shadow */
    }

    .card:hover .card-bg {
        transform: scale(1.05);
    }


    .image-container {
        position: relative;
        width: 100%;
        height: 100%;
        transition: transform 0.3s ease;
        transform-style: preserve-3d !important;
    }

    /* Zoom effect on hover */
    .card:hover .image-container {
        transform: scale(1.02);
    }

    /* Effetto 3D Perspective Container */
    .card {
        perspective: 1200px !important;
        overflow: visible !important;
    }

    .image-container.transform-active {
        transform: translateZ(20px);
    }

    .image-wrapper {
        position: absolute;
        transition: left 2s ease-in-out;
        text-align: center;
        top: 65%;
        transform: translateY(-50%);
        width: calc(var(--image-width));
    }

    /* Wrapper della nuvoletta */
    .bubble-wrapper {
        position: absolute;
        width: 150%;
        bottom: 100%;
        left: -25%;
        display: flex;
        justify-content: center;
        margin-bottom: var(--speech-bubble-space);
        z-index: 10;
    }

    .image {
        width: 100%;
        height: auto;
        max-width: var(--image-width);
        max-height: var(--image-height);
        object-fit: contain;
        transition: none;
    }

    /* Stili per le etichette sotto le immagini */
    .image-label {
        display: block;
        margin-top: -8px;
        font-size: 13px;
        font-weight: bold;
        background-color: rgba(255, 255, 255, 0.8);
        padding: 4px 4px;
        border-radius: 16px;
        box-shadow: 0 4px 10px #9495EA66;
        transition: none;
        position: relative;
        z-index: 5;
    }

    /* Stile speciale per la targhetta dell'avatar utente */
    .image-label.user-avatar {
        background: var(--gradient-primary); /* Make sure --gradient-primary is defined */
        box-shadow: 0 4px 10px #9495EA66;
        font-weight: bold;
        border: 2px solid #fff;
        padding: 4px 0px;
    }

    .user-icon {
        font-style: normal;
        margin-left: 5px;
    }

    @keyframes pulse {
        0% { box-shadow: 0 3px 8px rgba(0, 0, 0, 0.2); }
        50% { box-shadow: 0 3px 15px rgba(177, 172, 250, 0.8); }
        100% { box-shadow: 0 3px 8px rgba(0, 0, 0, 0.2); }
    }

    /* Posizionamento immagini */
    #wrapper-center {
        left: 50%;
        transform: translate(-50%, -50%);
        z-index: 2;
    }

    #wrapper-left {
        left: 20%;
        transform: translate(-50%, -50%);
        z-index: 1;
    }

    #wrapper-right {
        left: 80%;
        transform: translate(-50%, -50%);
        z-index: 1;
    }

    /* Animazioni fluttuanti - solo movimento verticale */
    @keyframes floatCenter {
        0% { transform: translateY(0); }
        50% { transform: translateY(-5px); }
        100% { transform: translateY(0); }
    }

    @keyframes floatLeft {
        0% { transform: translateY(0); }
        50% { transform: translateY(5px); }
        100% { transform: translateY(0); }
    }

    @keyframes floatRight {
        0% { transform: translateY(0); }
        50% { transform: translateY(-5px); }
        100% { transform: translateY(0); }
    }

    #img-center {
        animation: floatCenter 3s ease-in-out infinite;
    }

    #img-left {
        animation: floatLeft 4s ease-in-out infinite;
    }

    #img-right {
        animation: floatRight 4s ease-in-out infinite;
    }

    /* Stile nuvoletta dei fumetti */
    .speech-bubble {
        width: var(--bubble-width);
        opacity: 0;
        transition: opacity 0.7s ease, transform 0.5s ease;
        pointer-events: none;
        max-width: 100%;
        transform-origin: bottom center;
        transform: scale(1.15);
    }

    .speech-bubble.visible {
        opacity: 1;
    }

    /* Assicurarsi che i titoli della sezione siano visibili */
    .section-title,
    .section-subtitles {
        position: relative;
        z-index: 5;
        width: 100%;
        text-align: center;
        margin-left: auto;
        margin-right: auto;
    }

    /* Media query ottimizzata per dispositivi mobili */
    @media screen and (max-width: 768px) {
        :root {
            --card-width: 90vw;
            --card-height: 56vw;
            --image-width: 21vw;
            --image-height: 29vw;
            --bubble-width: 30vw; /* Ridotto */
            --speech-bubble-space: -15px; /* Ridotto */
        }
        

        /* Decorazioni e struttura */
        /* .game-hub::after { ... } */

        .bubble-wrapper {
            width: 140%;
            left: -20%;
        }

        /* Etichette immagini */
        .image-label {
            font-size: 8px;
            padding: 1px 3px;
            margin-top: -5px;
        }

        .image-label.user-avatar {
            font-size: 8px;
            padding: 1px 0px;
            margin-top: -5px;
        }

        /* Posizionamento avatar */
        #wrapper-left { left: 20%; }
        #wrapper-right { left: 80%; }

        /* Layout card */
        .card-container {
            width: 100%;
            max-width: 100vw;
            overflow-y: visible;
        }

        /* --- MODIFICHE CHIAVE PER HOVER MOBILE --- */

        /* Resetta TUTTE le trasformazioni e ombre per la card su mobile */
        .card {
             transform: none !important;
             box-shadow: 0 4px 10px #9495EA66 !important; /* Forza ombra viola base */
             transition: none !important; /* Disabilita transizioni su mobile se causano problemi */
        }
        .card-bg {
             transform: none !important;
             box-shadow: inherit !important; /* Eredita ombra card base */
             transition: none !important;
        }
         .image-container {
             transform: none !important;
             transition: none !important;
         }

        /* Impedisce QUALSIASI cambiamento su hover per card, bg e container su mobile */
        .card:hover,
        .card:focus, /* Aggiunto per accessibilità/interazioni touch */
        .card:active { /* Aggiunto per interazioni touch */
            transform: none !important;
            box-shadow: 0 4px 10px #9495EA66 !important; /* Mantiene ombra viola base */
        }

        .card:hover .card-bg,
        .card:focus .card-bg,
        .card:active .card-bg {
            transform: none !important;
            box-shadow: inherit !important; /* Mantiene ombra viola ereditata */
        }

        .card:hover .image-container,
        .card:focus .image-container,
        .card:active .image-container {
            transform: none !important;
        }
    }
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Elementi DOM
    const wrapperLeft = document.getElementById('wrapper-left');
    const wrapperCenter = document.getElementById('wrapper-center');
    const wrapperRight = document.getElementById('wrapper-right');
    const speechBubbleLeft = document.getElementById('speech-bubble-left');
    const speechBubbleRight = document.getElementById('speech-bubble-right');
    const imageContainer = document.querySelector('.image-container');
    const card = document.querySelector('.card');

    // Controllo se è un dispositivo mobile
    const isMobile = window.matchMedia("(max-width: 768px)").matches;

    // Posizioni - aggiornate per migliore responsività
    const positionLeft = { left: isMobile ? '20%' : '20%' };
    const positionMeetLeft = { left: '35%' };
    const positionMeetRight = { left: '65%' };
    const positionRight = { left: isMobile ? '80%' : '80%' };

    // Configurazione iniziale
    wrapperLeft.style.left = positionLeft.left;
    wrapperRight.style.left = positionRight.left;

    // Immagini per le nuvolette
    const leftBubbleImages = [
        "immagini/nuvola1.png",
        "immagini/nuvola2.png"
    ];

    const rightBubbleImages = [
        "immagini/nuvola3.png",
        "immagini/nuvola4.png"
    ];

    // Indici immagini
    let leftImageIndex = 0;
    let rightImageIndex = 0;

    // Funzioni per mostrare le nuvolette
    function showLeftSpeechBubble() {
        speechBubbleLeft.src = leftBubbleImages[leftImageIndex];
        leftImageIndex = (leftImageIndex + 1) % leftBubbleImages.length;
        speechBubbleLeft.classList.add('visible');

        setTimeout(() => {
            speechBubbleLeft.classList.remove('visible');
        }, 2800);
    }

    function showRightSpeechBubble() {
        speechBubbleRight.src = rightBubbleImages[rightImageIndex];
        rightImageIndex = (rightImageIndex + 1) % rightBubbleImages.length;
        speechBubbleRight.classList.add('visible');

        setTimeout(() => {
            speechBubbleRight.classList.remove('visible');
        }, 2800);
    }

    // Funzioni per spostare le immagini
    function moveLeftToCenter() {
        // Prima impostiamo solo lo z-index senza transizione
        wrapperLeft.style.zIndex = '3';

        // Usiamo setTimeout per evitare che il cambio di z-index e posizione
        // avvengano simultaneamente e causino problemi di rendering
        setTimeout(() => {
            wrapperLeft.style.left = positionMeetLeft.left;
        }, 10);

        setTimeout(() => {
            showLeftSpeechBubble();
        }, 2000);

        setTimeout(() => {
            wrapperLeft.style.left = positionLeft.left;

            // Ripristiniamo lo z-index originale dopo che l'elemento
            // è tornato nella posizione iniziale
            setTimeout(() => {
                wrapperLeft.style.zIndex = '1';
            }, 2000);
        }, 4000);
    }

    function moveRightToCenter() {
        // Prima impostiamo solo lo z-index senza transizione
        wrapperRight.style.zIndex = '3';

        // Usiamo setTimeout per evitare che il cambio di z-index e posizione
        // avvengano simultaneamente e causino problemi di rendering
        setTimeout(() => {
            wrapperRight.style.left = positionMeetRight.left;
        }, 10);

        setTimeout(() => {
            showRightSpeechBubble();
        }, 2000);

        setTimeout(() => {
            wrapperRight.style.left = positionRight.left;

            // Ripristiniamo lo z-index originale dopo che l'elemento
            // è tornato nella posizione iniziale
            setTimeout(() => {
                wrapperRight.style.zIndex = '1';
            }, 2000);
        }, 4000);
    }

    // Avvio dell'animazione
    function startAnimationLoop() {
        moveLeftToCenter();

        let isLeftTurn = false;
        setInterval(() => {
            if (isLeftTurn) {
                moveLeftToCenter();
            } else {
                moveRightToCenter();
            }
            isLeftTurn = !isLeftTurn;
        }, 8000);
    }

    // Avvia l'animazione dopo un breve ritardo
    setTimeout(startAnimationLoop, 1000);

    // Aggiorna le dimensioni quando la finestra viene ridimensionata
    window.addEventListener('resize', function() {
        // Aggiorna il controllo per dispositivi mobili
        const newIsMobile = window.matchMedia("(max-width: 768px)").matches;

        // Se cambia da desktop a mobile o viceversa, aggiorna la variabile
        if (isMobile !== newIsMobile) {
            location.reload(); // Ricarica la pagina per applicare le modifiche
        }

        // Riconfigura posizioni
        wrapperLeft.style.left = positionLeft.left;
        wrapperRight.style.left = positionRight.left;
    });

    // ===== EFFETTO 3D MIGLIORATO =====
    // Applica effetto 3D solo su desktop, non su mobile
    const baseCardShadow = '0 0px 20px #9495EA66'; // Store base shadow from CSS

    if (!isMobile) {
        // Aggiungi effetto 3D al passaggio del mouse sulla card
        card.addEventListener('mousemove', function(e) {
            // Ottieni dimensioni e posizione della card
            const cardRect = card.getBoundingClientRect();
            const cardBg = card.querySelector('.card-bg');

            // Calcola la posizione relativa del cursore all'interno della card (da 0 a 1)
            const xRatio = (e.clientX - cardRect.left) / cardRect.width;
            const yRatio = (e.clientY - cardRect.top) / cardRect.height;

            // Calcola gli angoli di rotazione (intervallo da -12 a 12 gradi)
            const maxRotation = 12;
            const xRotation = maxRotation * (0.5 - yRatio);
            const yRotation = maxRotation * (xRatio - 0.5);

            // Applica la trasformazione all'intera card incluso lo sfondo
            card.style.transform = `rotateX(${xRotation}deg) rotateY(${yRotation}deg)`;

            // Aggiungi un'ombra VIOLA per enfatizzare l'effetto 3D
            // --secondary color is #9495EA -> rgb(140, 141, 212)
            card.style.boxShadow = `0 25px 50px rgba(140, 141, 212, 0.5),
                                ${yRotation * 0.5}px ${xRotation * -0.5}px 30px rgba(0,0,0,0.1)`;

            // Controlla se il cursore è sopra l'image container per applicare uno zoom aggiuntivo
            const imageContainerRect = imageContainer.getBoundingClientRect();
            if (
                e.clientX >= imageContainerRect.left &&
                e.clientX <= imageContainerRect.right &&
                e.clientY >= imageContainerRect.top &&
                e.clientY <= imageContainerRect.bottom
            ) {
                // Applica un leggero zoom aggiuntivo quando il mouse è sopra l'image container
                imageContainer.style.transform = 'scale(1.05)';
                // Zoom leggermente maggiore per lo sfondo
                cardBg.style.transform = 'scale(1.08)';
            } else {
                // Applica solo lo zoom base quando il mouse è sulla card ma non sull'image container
                imageContainer.style.transform = 'scale(1.02)';
                // Zoom base per lo sfondo
                cardBg.style.transform = 'scale(1.05)';
            }
        });

        // Reset della trasformazione quando il mouse esce dalla card
        card.addEventListener('mouseleave', function() {
            const cardBg = card.querySelector('.card-bg');
            card.style.transform = 'rotateX(0deg) rotateY(0deg)';
            card.style.boxShadow = baseCardShadow; // Revert to base purple shadow
            imageContainer.style.transform = 'scale(1)';
            cardBg.style.transform = 'scale(1)';
        });
    } else {
        // Su mobile, rimuovi tutte le trasformazioni di default e disabilita il zoom
        const cardBg = card.querySelector('.card-bg');
        card.style.transform = 'none';
        imageContainer.style.transform = 'none';
        cardBg.style.transform = 'none';

        // Su mobile, gestisci il click per mostrare un'ombra VIOLA
        card.addEventListener('click', function() {
            // Crea effetto pulsante con ombra viola
            // --secondary color is #9495EA -> rgb(140, 141, 212)
            card.style.boxShadow = '0 15px 30px rgba(140, 141, 212, 0.5)';

            // Rimuovi l'effetto dopo un breve periodo, tornando all'ombra base
            setTimeout(() => {
                card.style.boxShadow = baseCardShadow;
            }, 500);
        });
    }
});
</script>

</section>


    <!-- How It Works Section -->
<section id="how-it-works" class="how-it-works section">
    <div class="container">
        <h2 class="section-title">Tutorial</h2>

        <div class="timeline">
            <div class="timeline-line"></div>

            <!-- Step 1 -->
            <div class="timeline-item left">
                <div class="timeline-dot"></div>
                <div class="timeline-content">
                    <div class="step-number">1</div>
                    <h4 class="step-description">Registrati e configura il tuo profilo</h4>
                    <p>Inizia scaricando l'app e creando un account in pochi secondi. Inserisci le tue informazioni finanziarie di base e personalizza le impostazioni.</p>
                </div>
            </div>

            <!-- Step 2 -->
            <div class="timeline-item right">
                <div class="timeline-dot"></div>
                <div class="timeline-content">
                    <div class="step-number">2</div>
                    <h4 class="step-description">Imposta i tuoi obiettivi finanziari</h4>
                    <p>Definisci cosa vuoi ottenere: risparmiare per una vacanza, acquistare una casa o semplicemente costruire un fondo di emergenza.</p>
                </div>
            </div>

            <!-- Step 3 -->
            <div class="timeline-item left">
                <div class="timeline-dot"></div>
                <div class="timeline-content">
                    <div class="step-number">3</div>
                    <h4 class="step-description">Traccia le tue spese quotidiane</h4>
                    <p>Registra facilmente ogni transazione e categorizzala. Con il tempo, otterrai informazioni preziose sulle tue abitudini di spesa.</p>
                </div>
            </div>

            <!-- Step 4 -->
            <div class="timeline-item right">
                <div class="timeline-dot"></div>
                <div class="timeline-content">
                    <div class="step-number">4</div>
                    <h4 class="step-description">Analizza e migliora</h4>
                    <p>Utilizza i rapporti e le analisi per comprendere meglio le tue finanze e apportare modifiche che ti aiuteranno a raggiungere i tuoi obiettivi più velocemente.</p>
                </div>
            </div>
        </div> <!-- Fine .timeline -->
    </div>

    <!-- Ticker/Scrolling Bar (fuori dal container, dentro la section) -->
    <div class="ticker-wrap">
        <div class="ticker">
            <div class="ticker-item">
                <span class="disclaimer-point">DISCLAIMER:</span>
                <span class="disclaimer-text">Strush non assicura di farti diventare milionario</span>
                <span class="ticker-separator">*</span>
                <span class="disclaimer-text">Purtroppo se non smetti di comprare mini aspirapolvere USB per tastiera, sarà dura</span>
                <span class="ticker-separator">*</span>
                <span class="disclaimer-text">Non possiamo prometterti che il tuo amico scroccone ti restituisca i soldi</span>
                <span class="ticker-separator">*</span>
                <span class="disclaimer-text">Strush non garantisce che smetterai di ordinare il Glovoo cinque volte a settimana</span>
                <span class="ticker-separator">*</span>
                <span class="disclaimer-text">L'app non stampa i soldi e non cancella i debiti</span>
                <span class="ticker-separator">*</span>
                <span class="disclaimer-text">L'uso prolungato potrebbe causare la drastica riduzione di amici che scroccano</span>
                <span class="ticker-separator">*</span>
                <span class="disclaimer-text">Effetti collaterali possono includere attacchi di parsimonia</span>
        </div>
    </div>

    <style>
        .how-it-works {
            background-color: white;
            position: relative;
        }

        .timeline {
            position: relative; margin: 0 auto 3rem; padding: 2rem 0; max-width: 1000px;
        }

        .timeline-line {
            position: absolute; top: 0; bottom: 0; left: 50%; width: 4px;
            background: var(--gradient-primary); transform: translateX(-50%); border-radius: 16px;
        }

        .timeline-line:after {
            content: ''; position: absolute; bottom: -10px; left: 50%; transform: translateX(-50%);
            width: 0; height: 0; border-left: 10px solid transparent; border-right: 10px solid transparent;
            border-top: 15px solid var(--secondary);
        }

        .timeline-item {
            position: relative; margin-bottom: 4rem; width: 100%; display: flex;
        }
        .timeline-item.left { justify-content: flex-start; }
        .timeline-item.right { justify-content: flex-end; }

        .timeline-dot {
            position: absolute; top: 24px; left: 50%; width: 20px; height: 20px;
            background: white; border: 4px solid var(--secondary); border-radius: 50%;
            transform: translateX(-50%); z-index: 2;
        }

        .timeline-content {
            width: 45%; background: white; padding: 32px; border-radius: 24px;
            border: 1px solid var(--secondarylight);
            box-shadow: 0 4px 10px #9495EA66;
            transition: box-shadow 0.3s ease, transform 0.3s ease;
            position: relative;
        }

        /* Stili Hover Desktop */
        @media (hover: hover) and (min-width: 768px) { /* Applica solo se il device supporta hover e non è mobile */
            .timeline-content:hover {
                box-shadow: 0 4px 10px #9495EA66;
            }

            .timeline-content:hover .step-number {
                border-radius: var(--step-blob-shape, 50%);
                transform: scale(1.1) rotate(5deg);
                background: linear-gradient(135deg, #84CD9D 60%, #9495EA 100%);
            }
        }


        .timeline-item.left .timeline-content:before,
        .timeline-item.right .timeline-content:before {
            content: ''; position: absolute; top: 34px; /* Allinea al dot */
            width: 40px; height: 2px; background-color: var(--secondary); z-index: 1;
        }
        .timeline-item.left .timeline-content:before { right: -40px; }
        .timeline-item.right .timeline-content:before { left: -40px; }


        .step-number {
            width: 50px; height: 50px; border-radius: 50%; background: var(--gradient-primary);
            display: flex; align-items: center; justify-content: center;
            font-size: 1.5rem; font-weight: bold; /* Changed color slightly for contrast */
            margin-bottom: 1rem; position: relative; z-index: 1;
            transition: border-radius 0.3s cubic-bezier(0.34, 1.56, 0.64, 1),
                        transform 0.3s ease, box-shadow 0.3s ease, background 0.3s ease;
            color: var(--text);
;

        }

        .step-description { margin-top: 0; margin-bottom: 8px;}
        .timeline-content p { margin-bottom: 0}

        /* Curva inferiore */
        .how-it-works::after {
            content: ''; position: absolute; bottom: -29px; left: 0; width: 100%; height: 30px;
            background: white; border-radius: 0 0 50% 50% / 0 0 100% 100%; z-index: 2;
        }

        /* Ticker Styles */
            .ticker-wrap {
            width: 100%; overflow: hidden; background: #121212;
            position: relative;
            transition: box-shadow 0.3s ease; cursor: pointer; padding: 8px 0; /* Padding verticale */
            }
            .ticker {
                display: inline-block; white-space: nowrap; padding-left: 100%;
                animation: ticker 45s linear infinite;
            }
            .ticker-wrap:hover .ticker { animation-play-state: paused !important; }
            .ticker-item {
                display: inline-block; font-size: 1rem; font-weight: 600;
                color: #9495EA !important;
                transition: color 0.3s ease; margin-right: 3rem; /* Spazio tra ripetizioni item */
            }
        .ticker-wrap:hover .ticker-item,
        .ticker-wrap:hover .disclaimer-text,
        .ticker-wrap:hover .disclaimer-point,
        .ticker-wrap:hover .ticker-separator { color: #84CD9D !important; }

        .ticker-separator {
            font-size: 1.3rem; font-weight: 700; margin: 0 0.8rem;
            vertical-align: middle; display: inline-block; color: #9495EA;
            transition: color 0.3s ease;
        }
        .disclaimer-text, .disclaimer-point {
            color: #9495EA; transition: color 0.3s ease; margin-right: 0.5rem;
        }
        .disclaimer-point { font-weight: bold; }

            @keyframes ticker {
                0% { transform: translateX(0); }
                100% { transform: translateX(-100%); } /* Loop fluido */
            }

            /* Media query How It Works Mobile */
            @media (max-width: 768px) {
                .timeline-line { left: 20px; }
                .timeline-dot { left: 20px; width: 16px; height: 16px; border-width: 3px; }
                .timeline-item { margin-bottom: 2rem; }
                .timeline-item.left, .timeline-item.right { justify-content: flex-start; padding-left: 45px; padding-right: 10px; }
                .timeline-content { width: 100%; padding: 1.5rem; }
                .timeline-item.left .timeline-content:before, .timeline-item.right .timeline-content:before {
                    left: -25px; right: auto; width: 25px; top: 32px;
                }
                .ticker-item { font-size: 18px; margin-right: 1.5rem; }

                /* MODIFICATO: Rallenta il ticker su mobile aumentando la durata */
                .ticker {
                animation-duration: 60s; /* Era 30s, aumentato per rallentare */
                }

                .timeline-content.is-centered .step-number {
                border-radius: var(--step-blob-shape, 50%);
                transform: scale(1.1) rotate(5deg);
                background: var(--gradient-primary);
                }

                .how-it-works::after {
                bottom: -24px;
                height: 25px;
                }
            }
    </style>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- Logica per le forme blob dei numeri dei passaggi (invariata) ---
            const stepNumbers = document.querySelectorAll('.how-it-works .step-number');
            if (stepNumbers.length > 0) {
                const stepBlobShapes = [
                    '60% 40% 65% 35% / 35% 65% 35% 65%',
                    '40% 60% 30% 70% / 60% 30% 70% 40%',
                    ' 60% 40% 50% 50% / 35% 65% 35% 65%',
                    '40% 60% 40% 60% / 70% 30% 70% 30%'
                ];
                stepNumbers.forEach((stepNumber, index) => {
                    const blobShape = stepBlobShapes[index % stepBlobShapes.length];
                    stepNumber.style.setProperty('--step-blob-shape', blobShape);
                });
            }

            // --- NUOVO: Logica per attivare la timeline card centrale su mobile ---
            const timelineItems = document.querySelectorAll('.how-it-works .timeline-content');
            const mobileMediaQuery = window.matchMedia('(max-width: 768px)');
            let scrollTimeout; // Per throttling leggero

            function checkTimelineActivation() {
                // Esegui solo su mobile
                if (!mobileMediaQuery.matches || timelineItems.length === 0) {
                    // Se non siamo più su mobile, rimuovi la classe da tutti
                    timelineItems.forEach(item => item.classList.remove('is-centered'));
                    return;
                }

                const viewportCenterY = window.innerHeight / 2;
                let closestItem = null;
                let minDistance = Infinity;

                timelineItems.forEach(item => {
                    const rect = item.getBoundingClientRect();
                    // Calcola il centro verticale dell'elemento rispetto alla viewport
                    const itemCenterY = rect.top + rect.height / 2;
                    const distance = Math.abs(viewportCenterY - itemCenterY);

                    // Considera solo elementi visibili (almeno parzialmente)
                    if (rect.bottom > 0 && rect.top < window.innerHeight) {
                        if (distance < minDistance) {
                            minDistance = distance;
                            closestItem = item;
                        }
                    }
                });

                // Rimuovi la classe da tutti tranne il più vicino (se trovato)
                timelineItems.forEach(item => {
                    if (item === closestItem) {
                            // Aggiungi un piccolo threshold per evitare attivazioni troppo sensibili
                            // Se l'elemento più vicino è effettivamente "vicino" al centro
                            if (minDistance < (viewportCenterY * 0.5) ) { // Ad es. entro metà altezza viewport dal centro
                            item.classList.add('is-centered');
                            } else {
                                item.classList.remove('is-centered'); // Rimuovi se non è abbastanza vicino
                            }
                    } else {
                        item.classList.remove('is-centered');
                    }
                });
            }

            // Funzione per gestire lo scroll con throttling
            function handleScroll() {
                clearTimeout(scrollTimeout);
                scrollTimeout = setTimeout(checkTimelineActivation, 50); // Esegui max ogni 50ms
            }

            // Aggiungi event listener per scroll e resize
            window.addEventListener('scroll', handleScroll);
            window.addEventListener('resize', checkTimelineActivation); // Controlla anche al resize

            // Esegui un controllo iniziale al caricamento
            checkTimelineActivation();

        }); // Fine DOMContentLoaded
    </script>

</section>


    <!-- Testimonials Section -->
<section id="testimonials" class="testimonials section">

    <div class="container">
        <h2 class="section-title">Cosa Dicono Gli Utenti</h2>

        <!-- Story Container -->
        <div class="story-container">
            <!-- Progress Bars -->
            <div class="progress-bars">
                <div class="progress-bar">
                    <div class="progress-fill"></div>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill"></div>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill"></div>
                </div>
            </div>

            <!-- Stories Content -->
            <div class="stories-content">
                <div class="story active">
                    <div class="story-inner">
                        <div class="blob blob-1"></div>
                        <div class="blob blob-2"></div>
                        <div class="quote-icon">
                            <svg width="40" height="40" viewBox="0 0 24 24" fill="#9495EA">
                                <path d="M10,7L8,11H11V17H5V11L7,7H10M18,7L16,11H19V17H13V11L15,7H18Z" />
                            </svg>
                        </div>
                        <div class="testimonial-content">
                            <p>È una specie di gioco! Tenere sotto controllo le spese è diventato qualcosa che voglio fare, non che devo fare.</p>
                        </div>
                        <div class="testimonial-author">
                            <div class="avatar-blob avatar-shape-1" id="avatar-blob-1">
                                <img src="immagini/testimonial 1.jpg" alt="Scapi A." class="testimonial-avatar">
                            </div>
                            <div class="testimonial-info">
                                <h5>Scapi A.</h5>
                                <p>Utente da 6 mesi</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="story">
                    <div class="story-inner">
                        <div class="blob blob-1"></div>
                        <div class="blob blob-2"></div>
                        <div class="quote-icon">
                            <svg width="40" height="40" viewBox="0 0 24 24" fill="#9495EA">
                                <path d="M10,7L8,11H11V17H5V11L7,7H10M18,7L16,11H19V17H13V11L15,7H18Z" />
                            </svg>
                        </div>
                        <div class="testimonial-content">
                            <p>L'app più intuitiva che abbia mai usato. Ogni volta che sblocco un badge mi sento tipo livello 10 del risparmio.</p>
                        </div>
                        <div class="testimonial-author">
                             <div class="avatar-blob avatar-shape-2" id="avatar-blob-2">
                                <img src="immagini/testimonial 2.jpg" alt="Sgabbi Y." class="testimonial-avatar">
                            </div>
                            <div class="testimonial-info">
                                <h5>Sgabbi Y.</h5>
                                <p>Utente da 1 anno</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="story">
                    <div class="story-inner">
                        <div class="blob blob-1"></div>
                        <div class="blob blob-2"></div>
                        <div class="quote-icon">
                            <svg width="40" height="40" viewBox="0 0 24 24" fill="#9495EA">
                                <path d="M10,7L8,11H11V17H5V11L7,7H10M18,7L16,11H19V17H13V11L15,7H18Z" />
                            </svg>
                        </div>
                        <div class="testimonial-content">
                            <p>Chi l'avrebbe mai detto che mi sarei gasato per aver messo da parte 5 euro?</p>
                        </div>
                        <div class="testimonial-author">
                            <div class="avatar-blob avatar-shape-3" id="avatar-blob-3">
                                <img src="immagini/testimonial 3.jpg" alt="Baluiso A." class="testimonial-avatar">
                            </div>
                            <div class="testimonial-info">
                                <h5>Baluiso A.</h5>
                                <p>Utente da 8 mesi</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <style>
        .testimonials {
            background: #E6F2F5;
            position: relative;
        }


        /* Bottom curve - maintained from original */
        .testimonials::after {
            content: '';
            position: absolute;
            bottom: -29px;
            left: 0;
            width: 100%;
            height: 30px;
            background: #E6F2F5;
            border-radius: 0 0 50% 50% / 0 0 100% 100%;
            z-index: 2;
        }


        /* Story container styles */
        .story-container {
            position: relative;
            max-width: 900px;
            margin: auto auto auto auto;
            overflow: hidden;
            cursor: pointer;
            padding-bottom: 20px;
            padding-left: 20px;
            padding-right: 20px;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
            -webkit-touch-callout: none;
        }

        /* Progress bars styles */
        .progress-bars { display: flex; gap: 8px; margin-bottom: 20px; }
        .progress-bar { height: 4px; flex: 1; background: rgba(0, 0, 0, 0.1); border-radius: 2px; overflow: hidden; }
        .progress-fill { height: 100%; width: 0%; background: var(--secondary); border-radius: 2px; transition: width 0.1s linear; }
        .progress-fill.completed { width: 100%; }
        .progress-fill.no-transition { transition: none; }

        /* Stories content styles */
        .stories-content { position: relative; height: 380px; -webkit-tap-highlight-color: transparent; }
        .story { position: absolute; top: 0; left: 0; width: 100%; height: 100%; opacity: 0; transform: translateX(50px); transition: opacity 0.5s ease, transform 0.5s ease; pointer-events: none; }
        .story.active { opacity: 1; transform: translateX(0); pointer-events: all; }

        .story-inner {
            background: rgb(255, 255, 255);
            border-radius: var(--border-radius-big);
            border: 1px solid var(--secondarylight);
            padding: 32px;
            height: 100%;
            display: flex;
            flex-direction: column;
            position: relative;
            overflow: hidden;
            transition: box-shadow 0.3s ease, transform 0.1s ease, background-color 0.1s ease;
            -webkit-tap-highlight-color: transparent;
            outline: none;
            box-shadow: 0 4px 10px #9495EA66;
        }

        /* Irregular blob shapes */
        .blob { position: absolute; z-index: 0; border-radius: 30% 70% 70% 30% / 30% 30% 70% 70%;  }
        .blob-1 { top: -90px; left: -60px; width: 200px; height: 180px; background-color: #F3F3FF; transform: rotate(30deg); }
        .blob-2 { bottom: -80px; right: -40px; width: 220px; height: 200px; background-color: #F3F3FF; transform: rotate(-15deg); border-radius: 60% 40% 30% 70% / 60% 30% 70% 40%; }

        /* Quote icon styles */
        .quote-icon { margin-bottom: 24px; position: relative; z-index: 1; }

        /* Testimonial content styles */
        .testimonial-content { margin-bottom: 32px; flex-grow: 1; position: relative; z-index: 1; }
        .testimonial-content p { font-size: 24px; color: var(--text); }

        /* Testimonial author styles */
        .testimonial-author { display: flex; align-items: center; margin-top: auto; position: relative; z-index: 1; }

        /* Base avatar blob styles */
        .avatar-blob {
            width: 68px;
            height: 68px;
            position: relative;
            margin-right: 20px;
            transition: filter 0.3s ease, transform 0.3s ease;
            overflow: visible;
            
        }

        /* Common border properties for all avatar shapes */
        .avatar-blob::before {
            content: '';
            position: absolute;
            inset: calc(-1 * 3px);
            background: var(--gradient-primary);
            z-index: -1;
            border-radius: 50%;
            transition: border-radius 0.3s cubic-bezier(0.34, 1.56, 0.64, 1), background 0.3s ease;
        }

        /* Avatar image styles */
        .testimonial-avatar {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
            transition: border-radius 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            display: block;
            position: relative;
            z-index: 1;
        }

        /* Definizione delle forme blob per gli avatar */
        .avatar-shape-1 { --blob-shape: 60% 40% 65% 35% / 35% 65% 35% 65%; }
        .avatar-shape-2 { --blob-shape: 40% 60% 30% 70% / 60% 30% 70% 40%; }
        .avatar-shape-3 { --blob-shape: 70% 30% 60% 40% / 30% 70% 30% 70%; }

        .testimonial-info h5 { margin: 0 0 0.3rem; }
        .testimonial-info p { margin: 0; font-size: 14px; } /* Stile base per desktop/default */

        /* Stile per l'effetto di pressione attiva */
        .story-inner:active {
            background-color: #E9EAEA;
            transform: translateY(1px);
            transition: all 0.05s ease-out;
        }


        /* --- Stili Hover Desktop --- */
        @media (hover: hover) and (min-width: 768px) {
            .story-inner:hover {
                box-shadow: 0 4px 10px #9495EA66;
            }

            .story-inner:hover .avatar-blob::before {
                border-radius: var(--blob-shape);
                background: var(--gradient-secondary);
            }

            .story-inner:hover .avatar-blob {
                transform: scale(1.1) rotate(5deg);
            }

            .story-inner:hover .testimonial-avatar {
                border-radius: var(--blob-shape);
            }
        }


        /* Media query unificata per dispositivi mobili */
        @media (max-width: 768px) {

            .testimonials::after {
                bottom: -24px;
                height: 25px;
            }

            .story-inner { padding: 24px; }
            .testimonial-content { margin-bottom: 16px; }
            .stories-content { height: 300px; }
            .testimonial-content p { font-size: 18px;}
            .quote-icon { margin-bottom: 16px; }
            .quote-icon svg { width: 30px; height: 30px; }
            .avatar-blob { width: 50px; height: 50px; margin-right: 16px; }

            /* ---- MODIFICA QUI ---- */
            .testimonial-info p {
                font-size: 14px; /* Dimensione desiderata */
                /* Impedisce a iOS/Safari di ingrandire automaticamente il testo */
                -webkit-text-size-adjust: none;
                text-size-adjust: none;
            }
            /* ---- FINE MODIFICA ---- */

            .blob-1 { width: 120px; height: 100px; top: -50px; left: -30px; }
            .blob-2 { width: 130px; height: 110px; bottom: -40px; right: -20px; }

            .story.active .avatar-blob {
                transform: scale(1.1) rotate(5deg);
                transition: filter 0.3s ease, transform 0.3s ease;
            }
            .story.active .avatar-blob::before {
                border-radius: var(--blob-shape);
                background: var(--gradient-secondary);
                transition: border-radius 0.3s cubic-bezier(0.34, 1.56, 0.64, 1), background 0.3s ease;
            }
            .story.active .testimonial-avatar {
                border-radius: var(--blob-shape);
                 transition: border-radius 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            }
        }
    </style>

    <script>
        // Lo script rimane invariato come richiesto
        document.addEventListener('DOMContentLoaded', function() {
            const stories = document.querySelectorAll('.story');
            const progressBars = document.querySelectorAll('.progress-bar');
            const progressFills = document.querySelectorAll('.progress-fill');
            const storyContainer = document.querySelector('.story-container');

            let currentStoryIndex = 0;
            let animationFrameId;
            let startTime;
            const storyDuration = 5000; // 5 secondi per storia
            let progressIntervalId; // ID per l'intervallo di avanzamento

            // Funzione per mostrare una specifica storia
            function showStory(index) {
                stories.forEach(story => {
                    story.classList.remove('active');
                });
                stories[index].classList.add('active');
                startProgressAnimation(index);
            }

            // Funzione per animare la barra di progresso
            function startProgressAnimation(index) {
                if (animationFrameId) cancelAnimationFrame(animationFrameId);
                if (progressIntervalId) clearTimeout(progressIntervalId);

                progressFills.forEach((fill, i) => {
                    fill.style.transition = 'none'; // Reset senza animazione
                    if (i < index) {
                        fill.style.width = '100%';
                        fill.classList.add('completed');
                    } else {
                        fill.style.width = '0%';
                        fill.classList.remove('completed');
                    }
                });

                void progressFills[index].offsetWidth; // Forza reflow

                progressFills[index].style.transition = `width ${storyDuration / 1000}s linear`;
                progressFills[index].style.width = '100%';

                progressIntervalId = setTimeout(() => {
                    progressFills[index].classList.add('completed');
                    goToNextStory();
                }, storyDuration);
            }


            // Funzione per andare alla storia successiva
            function goToNextStory() {
                    // Completa la barra corrente istantaneamente
                if(progressFills[currentStoryIndex]){
                        progressFills[currentStoryIndex].style.transition = 'none';
                        progressFills[currentStoryIndex].style.width = '100%';
                        progressFills[currentStoryIndex].classList.add('completed');
                }


                currentStoryIndex = (currentStoryIndex + 1) % stories.length;

                // Se torniamo alla prima storia, resetta tutte le barre
                if (currentStoryIndex === 0) {
                        progressFills.forEach(fill => {
                            fill.style.transition = 'none';
                            fill.style.width = '0%';
                            fill.classList.remove('completed');
                    });
                        void progressFills[0].offsetWidth; // Forza reflow
                }

                showStory(currentStoryIndex);
            }

            // Click/Tap event per avanzare manualmente
            storyContainer.addEventListener('click', (e) => {
                e.preventDefault();
                if (progressIntervalId) clearTimeout(progressIntervalId);
                if (animationFrameId) cancelAnimationFrame(animationFrameId);
                goToNextStory();
            });


            // Pausa/Ripresa con visibilità pagina
            document.addEventListener('visibilitychange', () => {
                    if (progressIntervalId) clearTimeout(progressIntervalId);
                    if (animationFrameId) cancelAnimationFrame(animationFrameId);

                    if (!document.hidden) {
                    // Riparte l'animazione della storia corrente da capo quando torna visibile
                    showStory(currentStoryIndex);
                    } else {
                        if(progressFills[currentStoryIndex]){
                          progressFills[currentStoryIndex].style.transition = 'none'; // Stop animation
                        }
                    }
            });

            // Avvia automaticamente la prima storia
            showStory(0);
        });
    </script>

</section>


    <!-- Team Section -->
<section id="team" class="team section">

    <div class="container">
        <h2 class="section-title">Il Team</h2>

        <div class="team-grid">
            <div class="team-member">
                <div class="team-photo-wrapper">
                    <div class="team-photo shape-1">
                        <img src="immagini/team1.png" alt="Cristiano Miolla">
                    </div>
                </div>
                <h4 class="team-name">Cristiano Miolla</h4>
                <div class="team-role">CEO & Founder</div>
                <p class="team-bio">Appassionato di innovazione, guida Strush per rendere l’educazione finanziaria a misura di Gen Z</p>
                <div class="team-social">
                    <a href="#"><i class="fab fa-twitter"></i></a>
                    <a href="#"><i class="fab fa-linkedin"></i></a>
                    <a href="#"><i class="fab fa-instagram"></i></a>
                </div>
            </div>

            <div class="team-member">
                <div class="team-photo-wrapper">
                    <div class="team-photo shape-2">
                        <img src="immagini/team2.jpg" alt="Silvano Sorino">
                    </div>
                </div>
                <h4 class="team-name">Silvano Sorino</h4>
                <div class="team-role">Game Designer</div>
                <p class="team-bio">Concept artist nel mondo dei videogiochi, Silvano porta il suo know-how nella gamification</p>
                <div class="team-social">
                    <a href="#"><i class="fab fa-github"></i></a>
                    <a href="#"><i class="fab fa-twitter"></i></a>
                    <a href="#"><i class="fab fa-linkedin"></i></a>
                </div>
            </div>

            <div class="team-member">
                <div class="team-photo-wrapper">
                    <div class="team-photo shape-3">
                        <img src="immagini/team3.png" alt="Vito Carnimeo">
                    </div>
                </div>
                <h4 class="team-name">Vito Carnimeo</h4>
                <div class="team-role">Illustrator & Visual Artist</div>
                <p class="team-bio">Dà forma all’identità visiva e cura la comunicazione sui social, con uno stile fresco e riconoscibile</p>
                <div class="team-social">
                    <a href="#"><i class="fab fa-twitter"></i></a>
                    <a href="#"><i class="fab fa-linkedin"></i></a>
                    <a href="#"><i class="fab fa-instagram"></i></a>
                </div>
            </div>

            <div class="team-member">
                <div class="team-photo-wrapper">
                    <div class="team-photo shape-4">
                        <img src="immagini/team4.png" alt="Giuseppe Santoro">
                    </div>
                </div>
                <h4 class="team-name">Giuseppe Santoro</h4>
                <div class="team-role">UI/UX Designer</div>
                <p class="team-bio">Giuseppe progetta l’esperienza utente e l’interfaccia dell’app unendo funzionalità e accessibilità</p>
                <div class="team-social">
                    <a href="#"><i class="fab fa-linkedin"></i></a>
                    <a href="#"><i class="fab fa-github"></i></a>
                    <a href="#"><i class="fab fa-dribbble"></i></a>
                </div>
            </div>

        </div>
    </div>

    <style>
        .team {
            background-color: white;
            position: relative;
        }

        /* Bottom curve - reduced height */
        .team::after {
            content: '';
            position: absolute;
            bottom: -29px;
            left: 0;
            width: 100%;
            height: 30px;
            background: white;
            border-radius: 0 0 50% 50% / 0 0 100% 100%;
            z-index: 2;
        }

        .team-grid {
            display: grid;
            /* --- MODIFICA QUI --- */
            /* Definisci esplicitamente 4 colonne per mostrare tutti i membri su una riga */
            grid-template-columns: repeat(4, 1fr); /* Quattro colonne di uguale larghezza */
            /* --- FINE MODIFICA --- */
            gap: 5.5rem; /* Potrebbe essere necessario ridurre il gap se non c'è abbastanza spazio */
            margin-right: 20px; /* Potrebbe essere necessario ridurre i margini laterali */
            margin-left: 20px;  /* Potrebbe essere necessario ridurre i margini laterali */
        }

        .team-member {
            text-align: center;
            transition: transform 0.3s;
        }

        /* Only apply hover transform on desktop */
        @media (min-width: 768px) {
            .team-member:hover {
                transform: translateY(-10px);
            }
        }

        /* Photo wrapper for positioning */
        .team-photo-wrapper {
            width: 180px; /* Ridotto leggermente per adattarsi meglio a 4 colonne */
            height: 180px; /* Ridotto leggermente per adattarsi meglio a 4 colonne */
            margin: 0 auto 24px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .team-name {
        margin-bottom: 16px; 
        }

        .team-photo {
            width: 180px; /* Ridotto leggermente */
            height: 180px; /* Ridotto leggermente */
            position: relative;
            background: linear-gradient(135deg, #84CD9D 0%, #9495EA 100%);
            padding: 5px;
            overflow: hidden;
        }

        /* Different shapes for each team member */
        .shape-1 {
            border-radius: 60% 40% 65% 35% / 35% 65% 35% 65%;
        }

        .shape-2 {
            border-radius: 40% 60% 30% 70% / 60% 30% 70% 40%;
        }

        .shape-3 {
            border-radius: 70% 30% 60% 40% / 30% 70% 30% 70%;
        }

        /* NUOVA FORMA PER IL QUARTO MEMBRO */
        .shape-4 {
            border-radius: 40% 60% 40% 60% / 70% 30% 70% 30%; /* Esempio di nuova forma */
        }


        .team-photo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: inherit; /* Important: follow parent's border radius */
        }

        /* Hover animations for each shape */
        .team-member:hover .shape-1 {
            animation: morph-shape-1 5s infinite;
        }

        .team-member:hover .shape-2 {
            animation: morph-shape-2 5s infinite;
        }

        .team-member:hover .shape-3 {
            animation: morph-shape-3 5s infinite;
        }

        /* NUOVA ANIMAZIONE HOVER PER IL QUARTO MEMBRO */
        .team-member:hover .shape-4 {
            animation: morph-shape-4 5s infinite;
        }


        /* Different animation for each shape, starting from their respective initial forms */
        @keyframes morph-shape-1 {
            0% { border-radius: 60% 40% 65% 35% / 35% 65% 35% 65%; transform: rotate(0deg); }
            15% { border-radius: 55% 45% 70% 30% / 45% 55% 45% 55%; transform: rotate(4deg); }
            30% { border-radius: 41% 59% 27% 73% / 58% 28% 72% 42%; transform: rotate(9deg); }
            45% { border-radius:  60% 40% 50% 50% / 35% 65% 35% 65%; transform: rotate(4deg); }
            60% { border-radius: 55% 45% 35% 65% / 55% 45% 55% 45%; transform: rotate(-9deg); }
            75% { border-radius: 30% 70% 50% 50% / 60% 40% 60% 40%; transform: rotate(-12deg); }
            90% { border-radius: 60% 40% 70% 30% / 40% 60% 40% 60%; transform: rotate(-1deg); }
            100% { border-radius: 60% 40% 65% 35% / 35% 65% 35% 65%; transform: rotate(0deg); }
        }

        @keyframes morph-shape-2 {
             0% { border-radius: 40% 60% 30% 70% / 60% 30% 70% 40%; transform: rotate(0deg); }
             15% { border-radius: 55% 45% 70% 30% / 45% 55% 45% 55%; transform: rotate(4deg); }
            30% { border-radius: 41% 59% 27% 73% / 58% 28% 72% 42%; transform: rotate(9deg); }
            45% { border-radius:  60% 40% 50% 50% / 35% 65% 35% 65%; transform: rotate(4deg); }
            60% { border-radius: 55% 45% 35% 65% / 55% 45% 55% 45%; transform: rotate(-9deg); }
            75% { border-radius: 30% 70% 50% 50% / 60% 40% 60% 40%; transform: rotate(-12deg); }
            90% { border-radius: 60% 40% 70% 30% / 40% 60% 40% 60%; transform: rotate(-1deg); }
            100% { border-radius: 40% 60% 30% 70% / 60% 30% 70% 40%; transform: rotate(0deg); }
        }

        @keyframes morph-shape-3 {
             0% { border-radius: 70% 30% 60% 40% / 30% 70% 30% 70%; transform: rotate(0deg); }
             15% { border-radius: 55% 45% 70% 30% / 45% 55% 45% 55%; transform: rotate(4deg); }
            30% { border-radius: 41% 59% 27% 73% / 58% 28% 72% 42%; transform: rotate(9deg); }
            45% { border-radius:  60% 40% 50% 50% / 35% 65% 35% 65%; transform: rotate(4deg); }
            60% { border-radius: 55% 45% 35% 65% / 55% 45% 55% 45%; transform: rotate(-9deg); }
            75% { border-radius: 30% 70% 50% 50% / 60% 40% 60% 40%; transform: rotate(-12deg); }
            90% { border-radius: 60% 40% 70% 30% / 40% 60% 40% 60%; transform: rotate(-1deg); }
            100% { border-radius: 70% 30% 60% 40% / 30% 70% 30% 70%; transform: rotate(0deg); }
        }

        /* NUOVA ANIMAZIONE PER SHAPE 4 */
        @keyframes morph-shape-4 {
             0% { border-radius: 40% 60% 40% 60% / 70% 30% 70% 30%; transform: rotate(0deg); }
            15% { border-radius: 55% 45% 70% 30% / 45% 55% 45% 55%; transform: rotate(4deg); }
            30% { border-radius: 41% 59% 27% 73% / 58% 28% 72% 42%; transform: rotate(9deg); }
            45% { border-radius:  60% 40% 50% 50% / 35% 65% 35% 65%; transform: rotate(4deg); }
            60% { border-radius: 55% 45% 35% 65% / 55% 45% 55% 45%; transform: rotate(-9deg); }
            75% { border-radius: 30% 70% 50% 50% / 60% 40% 60% 40%; transform: rotate(-12deg); }
            90% { border-radius: 60% 40% 70% 30% / 40% 60% 40% 60%; transform: rotate(-1deg); }
            100% { border-radius: 40% 60% 40% 60% / 70% 30% 70% 30%; transform: rotate(0deg); }
        }


        .team-role {
            font-weight: 600;
            margin-bottom: 1rem;
            display: inline-block;
            background: linear-gradient(135deg, #84CD9D 0%, #9495EA 100%);
            padding: 8px 16px;
            border-radius: 32px;
            color: var(--text);

        }

        .team-bio {
            margin-bottom: 1.5rem;
        }

        .team-social {
            display: flex;
            justify-content: center;
            gap: 1rem;
        }

        .team-social a {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color:  #E9EAEA;
            color: #121212;
            transition: all 0.3s ease;
            text-decoration: none;
            position: relative;
            overflow: hidden;
            z-index: 1;
        }

        .team-social a::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--gradient-secondary);
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: -1;
        }

        .team-social a:hover {
            transform: translateY(-5px);
        box-shadow: 0 2px 8px #9495EA40;   
        }

        .team-social a:hover::before {
            opacity: 1;
        }

        /* Media query unificata per dispositivi mobili */
        /* Qui NON viene modificato nulla, quindi su mobile continuerà a mostrare 1 colonna */
        @media (max-width: 768px) {
            /* MODIFICA RESPONSIVE: Torna a 1 colonna su schermi piccoli */
            .team-grid {
                grid-template-columns: 1fr; /* Una colonna */
                gap: 4.5rem; /* Ripristina gap originale per mobile */
                margin-right: 15px; /* Margini più piccoli per mobile */
                margin-left: 15px; /* Margini più piccoli per mobile */
            }

            .team-photo-wrapper {
                width: 200px; /* Ripristina dimensione originale per mobile */
                height: 200px; /* Ripristina dimensione originale per mobile */
            }
            .team-photo {
                width: 200px; /* Ripristina dimensione originale per mobile */
                height: 200px; /* Ripristina dimensione originale per mobile */
            }

            .team::after{
                bottom: -24px;
                height: 25px;
            }

            /* Animazioni forme */
            .team-photo.active-mobile.shape-1 {
                animation: morph-shape-1 5s infinite;
            }

            .team-photo.active-mobile.shape-2 {
                animation: morph-shape-2 5s infinite;
            }

            .team-photo.active-mobile.shape-3 {
                animation: morph-shape-3 5s infinite;
            }

            /* NUOVA ANIMAZIONE MOBILE PER SHAPE 4 */
            .team-photo.active-mobile.shape-4 {
                animation: morph-shape-4 5s infinite;
            }
        }
    </style>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // Check if on mobile
        if (window.matchMedia('(max-width: 768px)').matches) {
            const teamPhotos = document.querySelectorAll('.team-photo');

            // Create Intersection Observer to detect when photos come into viewport
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    // If the element is in the viewport
                    if (entry.isIntersecting) {
                        // Remove active class from all photos first
                        teamPhotos.forEach(photo => {
                            photo.classList.remove('active-mobile');
                        });

                        // Add active class to just this photo
                        entry.target.classList.add('active-mobile');
                    }
                });
            }, {
                // Element is considered visible when 50% of it is in viewport
                threshold: 0.5,
                rootMargin: '0px'
            });

            // Start observing all team photos
            teamPhotos.forEach(photo => {
                observer.observe(photo);
            });
        }
    });
    </script>

</section>


    <!-- Download Section --> 
<section id="download" class="download section">

    <div class="container">         
        <div class="download-content">             
            <h4 class="headline">Pronto a migliorare la tua gestione finanziaria?</h4>             
            <p class="description">Scarica l'app Strush oggi stesso e inizia il tuo percorso verso una gestione finanziaria più semplice e consapevole.</p>             
            <div class="store-buttons">                 
                <a href="download.html" class="store-btn">                     
                    <i class="fab fa-apple"></i>                     
                    <div class="store-btn-text">                         
                        <span>Scarica su</span>                         
                        <span class="store-name">App Store</span>                     
                    </div>                 
                </a>                 
                <a href="download.html" class="store-btn">                     
                    <i class="fab fa-google-play"></i>                     
                    <div class="store-btn-text">                         
                        <span>Scarica su</span>                         
                        <span class="store-name">Google Play</span>                     
                    </div>                 
                </a>             
            </div>         
        </div>     
    </div>
    

    <style>         
        /* Download Section */         
        .download {             
            background: var(--gradient-primary);             
        }          
        .download-content {             
            text-align: center;             
            max-width: 800px;             
            margin: 0 auto;         
        }
        
        .headline { 
            color: var(--text);
            margin-bottom: 16px;
        }

        .description { 
            color: var(--text);
        }
            
        .store-buttons {             
            display: flex;             
            justify-content: center;             
            gap: 3rem;             
            margin-top: 24px;         
        }          
        .store-btn {             
            display: flex;             
            align-items: center;             
            background-color: var(--text);             
            color: white;             
            padding: 16px 24px;             
            border-radius: 16px;             
            transition: transform 0.3s, box-shadow 0.3s;             
            width: 220px;             
            justify-content: flex-start;         
        }          
        .store-btn:hover {             
            transform: translateY(-2px);             
            box-shadow: 0 4px 10px #6B6F6E33;         
        }          
        .store-btn i {             
            font-size: 2.2rem;             
            margin-right: 16px;             
            width: 38px;             
            text-align: left;         
        }          
        .store-btn-text {             
            display: flex;             
            flex-direction: column;             
            text-align: left;             
            flex: 1;         
        }          
        .store-name {             
            font-size: 18px;             
            font-weight: 600;         
        }          
        /* Media query for mobile devices */         
        @media (max-width: 768px) {             
            .store-buttons {                 
                flex-direction: column;                 
                align-items: center;
                gap: 1rem;                        
            }              
            .store-btn {                 
                width: 73%;
                max-width: 220px;                 
                justify-content: flex-start;                 
            }
            
            .store-btn i {
                font-size: 2.1rem;
                margin-right: 7px;
            }
            
            .store-name {
                font-size: 19px;
            }
        }     
    </style> 
    
</section>

    <!-- Footer Section --> 
<div id="footer-placeholder"></div>


<script src="js/include.js"></script>


</body>


</html>
